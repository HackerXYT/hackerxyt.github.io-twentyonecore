(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{1341:function(e,t){!function(){var t,r={days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],AM:"AM",PM:"PM",am:"am",pm:"pm",formats:{D:"%m/%d/%y",F:"%Y-%m-%d",R:"%H:%M",T:"%H:%M:%S",X:"%T",c:"%a %b %d %X %Y",r:"%I:%M:%S %p",v:"%e-%b-%Y",x:"%D"}},s=new function e(t,s,i){var n,o=t||r,a=s||0,c=i||!1,l=0;var u=function(e,t){var r;if(t)r=t.getTime(),c&&(t=new Date(t.getTime()+b(t)+a));else{var s=Date.now();s>l?(l=s,n=new Date(l),r=l,c&&(n=new Date(l+b(n)+a))):r=l,t=n}return function e(t,r,s,i){for(var n="",o=null,l=!1,u=t.length,h=!1,b=0;b<u;b++){var v=t.charCodeAt(b);if(!0!==l)37!==v?n+=t[b]:l=!0;else{if(45===v){o="";continue}if(95===v){o=" ";continue}if(48===v){o="0";continue}if(58===v){h&&"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[WARNING] detected use of unsupported %:: or %::: modifiers to strftime"),h=!0;continue}switch(v){case 65:n+=s.days[r.getDay()];break;case 66:n+=s.months[r.getMonth()];break;case 67:n+=d(Math.floor(r.getFullYear()/100),o);break;case 68:n+=e(s.formats.D,r,s,i);break;case 70:n+=e(s.formats.F,r,s,i);break;case 72:n+=d(r.getHours(),o);break;case 73:n+=d(f(r.getHours()),o);break;case 76:n+=m(Math.floor(i%1e3));break;case 77:n+=d(r.getMinutes(),o);break;case 80:n+=r.getHours()<12?s.am:s.pm;break;case 82:n+=e(s.formats.R,r,s,i);break;case 83:n+=d(r.getSeconds(),o);break;case 84:n+=e(s.formats.T,r,s,i);break;case 85:n+=d(p(r,"sunday"),o);break;case 87:n+=d(p(r,"monday"),o);break;case 88:n+=e(s.formats.X,r,s,i);break;case 89:n+=r.getFullYear();break;case 90:if(c&&0===a)n+="GMT";else{var y=r.toString().match(/\(([\w\s]+)\)/);n+=y&&y[1]||""}break;case 97:n+=s.shortDays[r.getDay()];break;case 98:n+=s.shortMonths[r.getMonth()];break;case 99:n+=e(s.formats.c,r,s,i);break;case 100:n+=d(r.getDate(),o);break;case 101:n+=d(r.getDate(),null==o?" ":o);break;case 104:n+=s.shortMonths[r.getMonth()];break;case 106:var w=new Date(r.getFullYear(),0,1),I=Math.ceil((r.getTime()-w.getTime())/864e5);n+=m(I);break;case 107:n+=d(r.getHours(),null==o?" ":o);break;case 108:n+=d(f(r.getHours()),null==o?" ":o);break;case 109:n+=d(r.getMonth()+1,o);break;case 110:n+="\n";break;case 111:n+=String(r.getDate())+g(r.getDate());break;case 112:n+=r.getHours()<12?s.AM:s.PM;break;case 114:n+=e(s.formats.r,r,s,i);break;case 115:n+=Math.floor(i/1e3);break;case 116:n+="\t";break;case 117:I=r.getDay();n+=0===I?7:I;break;case 118:n+=e(s.formats.v,r,s,i);break;case 119:n+=r.getDay();break;case 120:n+=e(s.formats.x,r,s,i);break;case 121:n+=(""+r.getFullYear()).slice(2);break;case 122:if(c&&0===a)n+=h?"+00:00":"+0000";else{var E,O=(E=0!==a?a/6e4:-r.getTimezoneOffset())<0?"-":"+",T=h?":":"",_=Math.floor(Math.abs(E/60)),S=Math.abs(E%60);n+=O+d(_)+T+d(S)}break;default:n+=t[b]}o=null,l=!1}}return n}(e,t,o,r)};return u.localize=function(t){return new e(t||o,a,c)},u.timezone=function(t){var r=a,s=c,i=typeof t;"number"!==i&&"string"!==i||(s=!0,"string"===i?r=("-"===t[0]?-1:1)*(60*parseInt(t.slice(1,3),10)+parseInt(t.slice(3,5),10))*60*1e3:"number"===i&&(r=60*t*1e3));return new e(o,r,s)},u.utc=function(){return new e(o,a,!0)},u}(r,0,!1),i=void 0!==e;i?(t=e.exports=l).strftime=u:(t=function(){return this||(0,eval)("this")}()).strftime=l;var n=i?"require('strftime')":"strftime",o={};function a(e,t){o[e]||("undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[WARNING] "+e+" is deprecated and will be removed in version 1.0. Instead, use `"+t+"`."),o[e]=!0)}function c(e){e.localize=s.localize.bind(s),e.timezone=s.timezone.bind(s),e.utc=s.utc.bind(s)}function l(e,t,r){return t&&t.days&&(r=t,t=void 0),r&&a("`"+n+"(format, [date], [locale])`","var s = "+n+".localize(locale); s(format, [date])"),(r?s.localize(r):s)(e,t)}function u(e,t,r){return r?a("`"+n+".strftime(format, [date], [locale])`","var s = "+n+".localize(locale); s(format, [date])"):a("`"+n+".strftime(format, [date])`",n+"(format, [date])"),(r?s.localize(r):s)(e,t)}t.strftimeTZ=function(e,t,r,i){"number"!=typeof r&&"string"!=typeof r||null!=i||(i=r,r=void 0);r?a("`"+n+".strftimeTZ(format, date, locale, tz)`","var s = "+n+".localize(locale).timezone(tz); s(format, [date])` or `var s = "+n+".localize(locale); s.timezone(tz)(format, [date])"):a("`"+n+".strftimeTZ(format, date, tz)`","var s = "+n+".timezone(tz); s(format, [date])` or `"+n+".timezone(tz)(format, [date])");return(r?s.localize(r):s).timezone(i)(e,t)},t.strftimeUTC=function(e,t,r){r?a("`"+n+".strftimeUTC(format, date, locale)`","var s = "+n+".localize(locale).utc(); s(format, [date])"):a("`"+n+".strftimeUTC(format, [date])`","var s = "+n+".utc(); s(format, [date])");return(r?h.localize(r):h)(e,t)},t.localizedStrftime=function(e){return a("`"+n+".localizedStrftime(locale)`",n+".localize(locale)"),s.localize(e)},c(l),c(u);var h=s.utc();function d(e,t){return""===t||e>9?e:(null==t&&(t="0"),t+e)}function m(e){return e>99?e:e>9?"0"+e:"00"+e}function f(e){return 0===e?12:e>12?e-12:e}function p(e,t){t=t||"sunday";var r=e.getDay();"monday"===t&&(0===r?r=6:r--);var s=Date.UTC(e.getFullYear(),0,1),i=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),n=(Math.floor((i-s)/864e5)+7-r)/7;return Math.floor(n)}function g(e){var t=e%10,r=e%100;if(r>=11&&r<=13||0===t||t>=4)return"th";switch(t){case 1:return"st";case 2:return"nd";case 3:return"rd"}}function b(e){return 6e4*(e.getTimezoneOffset()||0)}"function"!=typeof Date.now&&(Date.now=function(){return+new Date})}()},1342:function(e,t,r){"use strict";var s=r(2001);function i(e,t){return void 0===t&&(t=!0),e&&"object"==typeof e?function(e,t){return Object.keys(e).forEach((function(r){e[r]=i(e[r],t)})),e}(e,t):Array.isArray(e)?function(e,t){return e.forEach((function(r,s){e[s]=i(r,t)})),e}(e,t):s.is(e,t)?s.parse(e):e}e.exports=i},1343:function(e,t,r){"use strict";(function(e){
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(){return(r=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var s=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},n="object"==typeof i&&i&&i.Object===Object&&i,o="object"==typeof self&&self&&self.Object===Object&&self,a=n||o||Function("return this")(),c=function(){return a.Date.now()},l=a.Symbol,u=Object.prototype,h=u.hasOwnProperty,d=u.toString,m=l?l.toStringTag:void 0;var f=function(e){var t=h.call(e,m),r=e[m];try{e[m]=void 0;var s=!0}catch(e){}var i=d.call(e);return s&&(t?e[m]=r:delete e[m]),i},p=Object.prototype.toString;var g=function(e){return p.call(e)},b=l?l.toStringTag:void 0;var v=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":b&&b in Object(e)?f(e):g(e)};var y=function(e){return null!=e&&"object"==typeof e};var w=function(e){return"symbol"==typeof e||y(e)&&"[object Symbol]"==v(e)},I=/^\s+|\s+$/g,E=/^[-+]0x[0-9a-f]+$/i,O=/^0b[01]+$/i,T=/^0o[0-7]+$/i,_=parseInt;var S=function(e){if("number"==typeof e)return e;if(w(e))return NaN;if(s(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=s(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(I,"");var r=O.test(e);return r||T.test(e)?_(e.slice(2),r?2:8):E.test(e)?NaN:+e},k=Math.max,P=Math.min;var A=function(e,t,r){var i,n,o,a,l,u,h=0,d=!1,m=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var r=i,s=n;return i=n=void 0,h=t,a=e.apply(s,r)}function g(e){return h=e,l=setTimeout(v,t),d?p(e):a}function b(e){var r=e-u;return void 0===u||r>=t||r<0||m&&e-h>=o}function v(){var e=c();if(b(e))return y(e);l=setTimeout(v,function(e){var r=t-(e-u);return m?P(r,o-(e-h)):r}(e))}function y(e){return l=void 0,f&&i?p(e):(i=n=void 0,a)}function w(){var e=c(),r=b(e);if(i=arguments,n=this,u=e,r){if(void 0===l)return g(u);if(m)return l=setTimeout(v,t),p(u)}return void 0===l&&(l=setTimeout(v,t)),a}return t=S(t)||0,s(r)&&(d=!!r.leading,o=(m="maxWait"in r)?k(S(r.maxWait)||0,t):o,f="trailing"in r?!!r.trailing:f),w.cancel=function(){void 0!==l&&clearTimeout(l),h=0,i=u=n=l=void 0},w.flush=function(){return void 0===l?a:y(c())},w};var D=function(e,t,r){var i=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return s(r)&&(i="leading"in r?!!r.leading:i,n="trailing"in r?!!r.trailing:n),A(e,t,{leading:i,maxWait:t,trailing:n})},j=["scroll","resize"],C=["wheel","keydown","keyup","mousedown","mousemove","touchstart","touchmove","click","contextmenu"],N=function(){function e(e){var t=e.timeIntervalEllapsedCallbacks,s=void 0===t?[]:t,i=e.absoluteTimeEllapsedCallbacks,n=void 0===i?[]:i,o=e.checkCallbacksIntervalMs,a=void 0===o?100:o,c=e.browserTabInactiveCallbacks,l=void 0===c?[]:c,u=e.idleCallbacks,h=void 0===u?[]:u,d=e.stopTimerOnTabchange,m=void 0===d||d,f=e.activeCallbacks,p=void 0===f?[]:f,g=e.browserTabActiveCallbacks,b=void 0===g?[]:g,v=e.idleTimeoutMs,y=void 0===v?3e3:v,w=this;this.onBrowserTabInactive=function(){w.isRunning()&&w.stopTimerOnTabchange&&w.stopTimer(),w.browserTabInactiveCallbacks.forEach((function(e){return e(w.getTimeInMilliseconds())}))},this.onBrowserTabActive=function(){w.isRunning()||w.startTimer(),w.browserTabActiveCallbacks.forEach((function(e){return e(w.getTimeInMilliseconds())}))},this.onBrowserActiveChange=function(){"visible"===document.visibilityState?w.onBrowserTabActive():w.onBrowserTabInactive()},this.onTimePassed=function(){w.absoluteTimeEllapsedCallbacks.forEach((function(e,t){var r=e.callback,s=e.pending,i=e.timeInMilliseconds;s&&i<=w.getTimeInMilliseconds()&&(r(w.getTimeInMilliseconds()),w.absoluteTimeEllapsedCallbacks[t].pending=!1)})),w.timeIntervalEllapsedCallbacks.forEach((function(e,t){var r=e.callback,s=e.timeInMilliseconds,i=e.multiplier;s<=w.getTimeInMilliseconds()&&(r(w.getTimeInMilliseconds()),w.timeIntervalEllapsedCallbacks[t].timeInMilliseconds=i(s))})),w.currentIdleTimeMs>=w.idleTimeoutMs&&w.isRunning()?(w.idle=!0,w.stopTimer(),w.idleCallbacks.forEach((function(e){return e(w.getTimeInMilliseconds())}))):w.currentIdleTimeMs+=w.checkCallbacksIntervalMs},this.resetIdleTime=function(){w.idle&&w.startTimer(),w.activeCallbacks.forEach((function(e){return e(w.getTimeInMilliseconds())})),w.idle=!1,w.currentIdleTimeMs=0},this.registerEventListeners=function(){var e={passive:!0},t=r({},e,{capture:!0});document.addEventListener("visibilitychange",w.onBrowserActiveChange);var s=D(w.resetIdleTime,2e3,{leading:!0,trailing:!1});j.forEach((function(e){window.addEventListener(e,s,t)})),C.forEach((function(t){return document.addEventListener(t,s,e)}))},this.unregisterEventListeners=function(){document.removeEventListener("visibilitychange",w.onBrowserActiveChange),j.forEach((function(e){return window.removeEventListener(e,w.resetIdleTime)})),C.forEach((function(e){return document.removeEventListener(e,w.resetIdleTime)}))},this.checkCallbacksOnInterval=function(){w.checkCallbackIntervalId=window.setInterval((function(){w.onTimePassed()}),w.checkCallbacksIntervalMs)},this.startTimer=function(){w.checkCallbackIntervalId||w.checkCallbacksOnInterval();var e=w.times[w.times.length-1];e&&null===e.stop||(w.times.push({start:performance.now(),stop:null}),w.running=!0)},this.stopTimer=function(){w.times.length&&(w.times[w.times.length-1].stop=performance.now(),w.running=!1)},this.addTimeIntervalEllapsedCallback=function(e){w.timeIntervalEllapsedCallbacks.push(e)},this.addAbsoluteTimeEllapsedCallback=function(e){w.absoluteTimeEllapsedCallbacks.push(e)},this.addBrowserTabInactiveCallback=function(e){w.browserTabInactiveCallbacks.push(e)},this.addBrowserTabActiveCallback=function(e){w.browserTabActiveCallbacks.push(e)},this.addIdleCallback=function(e){w.idleCallbacks.push(e)},this.addActiveCallback=function(e){w.activeCallbacks.push(e)},this.getTimeInMilliseconds=function(){return w.times.reduce((function(e,t){return t.stop?e+=t.stop-t.start:e+=performance.now()-t.start,e}),0)},this.isRunning=function(){return w.running},this.isIdle=function(){return w.idle},this.reset=function(){w.times=[]},this.destroy=function(){w.unregisterEventListeners(),w.checkCallbackIntervalId&&window.clearInterval(w.checkCallbackIntervalId)},this.running=!1,this.times=[],this.idle=!1,this.currentIdleTimeMs=0,this.marks={},this.measures={},this.stopTimerOnTabchange=m,this.browserTabActiveCallbacks=b,this.browserTabInactiveCallbacks=l,this.checkCallbacksIntervalMs=a,this.idleTimeoutMs=y,this.timeIntervalEllapsedCallbacks=s,this.absoluteTimeEllapsedCallbacks=n,this.idleCallbacks=h,this.activeCallbacks=p,this.registerEventListeners()}return e.prototype.mark=function(e){this.marks[e]||(this.marks[e]=[]),this.marks[e].push({time:this.getTimeInMilliseconds()})},e.prototype.getMarks=function(e){if(!(this.marks[e].length<1))return this.marks[e]},e.prototype.measure=function(e,t,r){var s=this.marks[t],i=s[s.length-1],n=this.marks[r],o=n[n.length-1];this.measures[e]||(this.measures[e]=[]),this.measures[e].push({name:e,startTime:i.time,duration:o.time-i.time})},e.prototype.getMeasures=function(e){if(this.measures[e]||!(this.measures[e].length<1))return this.measures[e]},e}();t.a=N}).call(this,r(179))},2e3:function(e,t,r){r(2357),e.exports=r(322)},2001:function(e,t,r){"use strict";var s=/^(\d{4})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:([ T])(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;t.parse=function(e){var t=[1,5,6,7,11,12],r=s.exec(e),i=0;if(!r)return new Date(e);for(var n,o=0;n=t[o];o++)r[n]=parseInt(r[n],10)||0;r[2]=parseInt(r[2],10)||1,r[3]=parseInt(r[3],10)||1,r[2]--,r[8]=r[8]?(r[8]+"00").substring(0,3):0," "===r[4]?i=(new Date).getTimezoneOffset():"Z"!==r[9]&&r[10]&&(i=60*r[11]+r[12],"+"===r[10]&&(i=0-i));var a=Date.UTC(r[1],r[2],r[3],r[5],r[6]+i,r[7],r[8]);return new Date(a)},t.is=function(e,t){return"string"==typeof e&&((!t||!1!==/^\d{4}-\d{2}-\d{2}/.test(e))&&s.test(e))}},2357:function(e,t,r){"use strict";r.r(t);var s={};r.r(s),r.d(s,"default",(function(){return jr})),r.d(s,"apdexType",(function(){return E})),r.d(s,"envType",(function(){return g})),r.d(s,"eventType",(function(){return b})),r.d(s,"originType",(function(){return y})),r.d(s,"platformType",(function(){return v})),r.d(s,"tenantType",(function(){return w})),r.d(s,"userType",(function(){return I})),r.d(s,"originTracingType",(function(){return _})),r.d(s,"TypeAheadHelper",(function(){return Vr})),r.d(s,"DwellTimeHelper",(function(){return Lr})),r.d(s,"DwellTimeHelperWithBrowserInteraction",(function(){return Wr})),r.d(s,"CompressionRule",(function(){return ae})),r.d(s,"ResilienceMechanism",(function(){return Ke}));r(143),r(401),r(347);var i=r(481),n=r.n(i),o=r(1341),a=r.n(o),c=r(97),l=r.n(c),u=r(901),h=r.n(u),d=r(1),m=r.n(d),f=r(155),p=r.n(f);let g,b,v,y,w,I,E;!function(e){e.LOCAL="local",e.DEV="dev",e.STAGING="staging",e.PROD="prod"}(g||(g={})),function(e){e.TRACK="track",e.UI="ui",e.OPERATIONAL="operational",e.SCREEN="screen",e.IDENTIFY="identify"}(b||(b={})),function(e){e.MAC="mac",e.LINUX="linux",e.WINDOWS="windows",e.DESKTOP="desktop",e.WEB="web",e.MOBILE_WEB="mobileWeb"}(v||(v={})),function(e){e.DESKTOP="desktop",e.WEB="web"}(y||(y={})),function(e){e.CLOUD_ID="cloudId",e.ORG_ID="orgId",e.OPSGENIE_CUSTOMER_ID="opsgenieCustomerId",e.NONE="none"}(w||(w={})),function(e){e.ATLASSIAN_ACCOUNT="atlassianAccount",e.HASHED_EMAIL="hashedEmail",e.TRELLO="trello",e.OPSGENIE="opsgenie",e.HALP="halp"}(I||(I={})),function(e){e.TRANSITION="transition",e.INITIAL_LOAD="initialLoad"}(E||(E={}));const O=Object.freeze([v.DESKTOP,v.MAC,v.LINUX,v.WINDOWS]),T=Object.freeze([v.WEB,v.MOBILE_WEB]);let _;function S(e){return Object.values(e)}function k(e,t){return Object.values(e).indexOf(t)>-1}!function(e){e.ATL_ORIGIN="atlOrigin"}(_||(_={}));class P{constructor(){m()(this,"_bindEventListeners",()=>{document.addEventListener(this._visibilityChange,this._handleVisibilityChange,!1)}),m()(this,"_handleVisibilityChange",()=>{const e=document[this._hidden];this._isHidden=e,this._callbacks.forEach(t=>t(e))}),this._isHidden=!1,this._callbacks=new Map,this._hidden=void 0,this._visibilityChange=void 0,void 0!==document.hidden?(this._isHidden=document.hidden,this._hidden="hidden",this._visibilityChange="visibilitychange"):void 0!==document.msHidden?(this._isHidden=document.msHidden,this._hidden="msHidden",this._visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this._isHidden=document.webkitHidden,this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==this._hidden&&this._bindEventListeners()}addCallback(e,t){if("string"!=typeof e)throw new Error("Invalid name, must be string");if("function"!=typeof t)throw new Error("Invalid callback, must be function");this._callbacks.set(e,t)}removeCallback(e){this._callbacks.has(e)&&this._callbacks.delete(e)}getIsHidden(){return this._isHidden}}class A{constructor(){this._performance=window.performance}clearMarks(...e){this._performance&&this._performance.clearMarks&&this._performance.clearMarks(...e)}mark(...e){this._performance&&this._performance.mark&&this._performance.mark(...e)}getEntriesByName(...e){return this._performance&&this._performance.getEntriesByName?this._performance.getEntriesByName(...e):[]}getTimeOrigin(){return this._performance&&(this._performance.timeOrigin||this._performance.timing)?this._performance.timeOrigin||this._performance.timing.navigationStart:0}now(){return this._performance&&this._performance.now?this._performance.now():Date.now?Date.now():+new Date}isAvailable(){return!!(this._performance&&this._performance.clearMarks&&this._performance.mark&&this._performance.getEntriesByName&&this._performance.timing)}}function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class C{constructor(e,t){if(m()(this,"_getEventKey",({task:e,taskId:t})=>t?`${e}.${t}`:e),m()(this,"_getEventTimingByName",e=>{const t=this._performance.getEntriesByName(e);return t[t.length-1]}),m()(this,"_getApdexFields",e=>{const t=this._getApdexTimings(e),r=this._calculateApdex({duration:t.duration,threshold:e.threshold});return j(j({},t),{},{apdex:r})}),m()(this,"_getApdexTimings",e=>{const t=this._getEventKey(e),r=t+"-start",s=e.startTime||this._getStartTime(e,r),i=e.stopTime||this._getStopTime();return this._cleanApdexState(t),{startTime:s,stopTime:i,duration:i-s}}),m()(this,"_getStartTime",(e,t)=>{let r;const s=this._performance.getTimeOrigin();if(e.type===E.INITIAL_LOAD)r=s;else{r=s+this._getEventTimingByName(t).startTime}return r}),m()(this,"_getStopTime",()=>this._performance.getTimeOrigin()+this._performance.now()),m()(this,"_cleanApdexState",e=>{this._performance.clearMarks(e+"-start"),this._performance.clearMarks(e+"-stop"),this._startedEvents.delete(e)}),m()(this,"_getVisibilityFields",e=>{let t;if(e.type===E.INITIAL_LOAD)t=!this._wasPreviouslyHidden;else if(e.type===E.TRANSITION){const r=this._getEventKey(e);t=this._isActiveEvents.get(r)}return(e.startTime||e.stopTime)&&(t=!this._pageVisibility.getIsHidden()),{isActiveTab:t}}),m()(this,"_calculateApdex",({duration:e,threshold:t=this._threshold})=>{let r;return r=e<=t?1:e<=4*t?.5:0,r}),m()(this,"_validateStartEvent",e=>{if(!e)throw new Error('Missing "event" in Apdex start event');if(!e.task)throw new Error('Missing "task" in Apdex start event');if("string"!=typeof e.task)throw new Error('Invalid "task" in Apdex start event');if(e.taskId&&"string"!=typeof e.taskId)throw new Error('Invalid "taskId" in Apdex start event')}),m()(this,"_validateStopEvent",e=>{if(!e)throw new Error('Missing "event" in Apdex stop event');if(!e.task)throw new Error('Missing "task" in Apdex stop event');if("string"!=typeof e.task)throw new Error('Invalid "task" in Apdex stop event');if(e.taskId&&"string"!=typeof e.taskId)throw new Error('Invalid "taskId" in Apdex stop event');if(!e.type)throw new Error('Missing "type" in Apdex stop event');if(e.type&&!k(E,e.type))throw new Error('Invalid "type" in Apdex stop event');if(e.threshold&&"number"!=typeof e.threshold)throw new Error('Invalid "threshold" in Apdex stop event');if(!e.startTime&&e.type===E.TRANSITION){const t=this._getEventKey(e);if(!this._startedEvents.has(t))throw new Error(`Apdex event transition "${t}" was not started`)}if(e.startTime&&!("number"==typeof e.startTime&&e.startTime>=0))throw new Error('Invalid "startTime" in Apdex stop event');if(e.stopTime&&"number"!=typeof e.stopTime)throw new Error('Invalid "stopTime" in Apdex stop event');if(e.stopTime<=e.startTime)throw new Error('"stopTime" should be greater than "startTime" in Apdex stop event')}),m()(this,"_shouldSendEvent",e=>!!e&&"number"==typeof e.apdex),m()(this,"_sendEvent",(e,t)=>{this._shouldSendEvent(e)&&this._onEvent({source:"ui",action:"readyForUser",actionSubject:"ui",attributes:j(j({},e.additionalAttributes),{},{task:e.task,taskId:e.taskId,type:e.type,threshold:e.threshold||this._threshold,apdex:e.apdex,startTime:e.startTime,stopTime:e.stopTime,duration:e.duration,isActiveTab:e.isActiveTab})},t)}),!e)throw new Error("Missing onEvent callback");if("function"!=typeof e)throw new Error("Invalid onEvent, must be function");if(!(t instanceof P))throw new Error("Invalid pageVisibility, must be PageVisibility class");this._startedEvents=new Map,this._performance=new A,this._onEvent=e,this._threshold=1e3,this._wasPreviouslyHidden=t.getIsHidden(),this._isActiveEvents=new Map,this._pageVisibility=t,this._pageVisibility.addCallback("apdexEvent",e=>{this.onVisibilityChange(!e)})}start(e){if(this._validateStartEvent(e),!this._performance.isAvailable())return;const t=this._getEventKey(e),r=t+"-start";this._startedEvents.set(t,!0),this._isActiveEvents.set(t,!this._pageVisibility.getIsHidden()),this._performance.clearMarks(r),this._performance.mark(r)}getStart(e){if(this._validateStartEvent(e),!this._performance.isAvailable())return;const t=this._getEventKey(e)+"-start";return this._getEventTimingByName(t)}stop(e,t){if(this._validateStopEvent(e),!this._performance.isAvailable())return;const r=this._getApdexFields(e),s=this._getVisibilityFields(e);this._sendEvent(j(j(j({},e),r),s),t)}onVisibilityChange(e){e||(this._wasPreviouslyHidden=!0,this._isActiveEvents.forEach((e,t)=>this._isActiveEvents.set(t,!1)))}}var N=(e,t)=>()=>{if((e=>"function"==typeof e)(e))try{return e()}catch(e){return void console.error(`${t} - ${e.message}`)}return e};function M(e){return!0==(null!==(t=e)&&"object"==typeof t&&!1===Array.isArray(t))&&"[object Object]"===Object.prototype.toString.call(e);var t}function R(e){if(!1===M(e))return!1;const t=e.constructor;if("function"!=typeof t)return!1;const r=t.prototype;return!1!==M(r)&&"isPrototypeOf"in r}function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function U(e){return{tenantIdType:e.tenantIdType,tenantId:e.tenantId}}function F(e){return{userIdType:e.userIdType}}function B(e){return{orgId:e.orgId}}function H(e,t){return void 0===t?e:t}function W(e,t){const r=t||{};return{env:H(e.env,r.env),product:H(e.product,r.product),subproduct:H(e.subproduct(),r.subproduct),version:H(e.version,r.version),origin:H(e.origin,r.origin),platform:H(e.platform,r.platform)}}function $(e){return R(e)&&Object.keys(e).length>0}function G(e,t){return $(t)?{[e]:t}:void 0}function K(e){if($(e)){return G("containers",function(e){const t={};return Object.keys(e).forEach(r=>{const s=e[r];t[r]={id:s.id,type:s.type}}),t}(e))}}function V(e,t){return L({containerType:e.containerType,containerId:e.containerId,source:e.source,objectType:e.objectType,objectId:e.objectId,actionSubject:e.actionSubject,action:e.action,actionSubjectId:e.actionSubjectId,attributes:e.attributes,nonPrivacySafeAttributes:e.nonPrivacySafeAttributes,tags:e.tags,highPriority:e.highPriority,eventType:t},K(e.containers))}function z(e,t,r,s,i,n,o,a,c,l,u,h){const d=W(e),m=U(t),f=F(r),p=B(l),g={title:"",path:"",url:"",referrer:"",search:"",eventType:b.SCREEN};return L(L(L(L(L(L(L(L(L({},d),m),f),p),g),function(e){return G("attributes",e)}(s)),function(e){return G("nonPrivacySafeAttributes",e)}(i)),K(h)),{},{tags:n,tabId:o,sessionId:a,taskSessions:c,pageLoadId:u})}function q(e){return`${e.actionSubject} ${e.action}`}function Q(e,t,r,s,i,n,o,a,c,l){const u=W(e,function(e){const{env:t,product:r,subproduct:s,version:i,origin:n,platform:o}=e;return{env:t,product:r,subproduct:s,version:i,origin:n,platform:o}}(s)),h=U(t),d=B(c),m=F(r),f=V(s,i);return L(L(L(L(L(L({},u),h),d),m),f),{},{tabId:n,sessionId:o,taskSessions:a,pageLoadId:l})}const J=Object.freeze([b.OPERATIONAL,b.TRACK,b.UI]);function X(e){if(e){if(e&&e.constructor!==Object)throw new Error("properties.containers must be an Object");Object.values(e).forEach(e=>function(e){if(!R(e))throw new Error("properties.containers must be an Object");if(!("id"in e))throw new Error("properties.containers is missing field 'id'");if("string"!=typeof e.id)throw new Error("properties.containers.id must be of type String");if("type"in e&&"string"!=typeof e.type)throw new Error("properties.containers.type must be of type String")}(e))}}function Y(e){switch(e){case b.OPERATIONAL:case b.TRACK:case b.UI:return!0;default:return!1}}function Z(e){if(!e)throw new Error("Missing event");if(!e.source)throw new Error("Missing event.source");if(!e.actionSubject)throw new Error("Missing event.actionSubject");if(!e.action)throw new Error("Missing event.action");X(e.containers)}function ee(e){if(!e)throw new Error("Missing event");if(!e.source)throw new Error("Missing event.source");if(!e.actionSubject)throw new Error("Missing event.actionSubject")}const te=(e,t)=>Object.keys(e).reduce((r,s)=>(r[t(e[s],s,e)]=e[s],r),{}),re=(e,t)=>Object.keys(e).filter(e=>t.indexOf(e)<0).reduce((t,r)=>(t[r]=e[r],t),{}),se=(e,t)=>{if(e===t)return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return e===t;if(e.prototype!==t.prototype)return!1;const r=Object.keys(e);return r.length===Object.keys(t).length&&r.every(r=>se(e[r],t[r]))},ie=(e,t)=>e.reduce((e,r,s,i)=>(e[t(r,s,i)?0:1].push(r),e),[[],[]]);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class ae{constructor(e,t){if(m()(this,"canCompress",e=>{try{return e&&Y(e.eventType)&&this._predicate(e)}catch(e){return!1}}),m()(this,"compress",e=>{const[t,r]=ie(e,e=>this.canCompress(e)),s=this._compressFn(t);if(!s)throw new Error("No events were returned from the compression function");return s.forEach(e=>{!function(e){if(!Y(e))throw new Error(`Invalid action event type: ${e}, must be one of: [${J}]`)}(e.eventType),Z(e)}),s.concat(r)}),"function"!=typeof e)throw new Error("Invalid predicate, must be a function that accepts an event and returns a boolean");if("function"!=typeof t)throw new Error("Invalid compressFn, must be a function that both accepts and returns an array of events");this._predicate=e,this._compressFn=t}}class ce{constructor(e=[]){if(m()(this,"canCompress",e=>this._compressionRules.some(t=>t.canCompress(e))),m()(this,"compress",e=>this._createGroups(e).reduce((e,t)=>(this._compressGroup(t).forEach(t=>e.push(t)),e),[])),m()(this,"_createGroups",e=>e.reduce((e,t)=>{let r,s=null;for(let e=0;e<this._compressionRules.length;e++){const r=this._compressionRules[e];if(r.canCompress(t)){s=r;break}}if(s){const e=V(t,t.eventType);r=re(t,Object.keys(e))}let i=null;for(let t=0;t<e.length;t++){const n=e[t];if(s===n.compressor&&se(r,n.contextFields)){i=n;break}}return i?i.events.push(t):e.push({contextFields:r,compressor:s,events:[t]}),e},[])),m()(this,"_compressGroup",e=>{if(!e.compressor)return e.events;try{return e.compressor.compress(e.events).map(t=>oe(oe({},t),e.contextFields))}catch(t){return console.warn(`Failed to compress some analytics events. Error: ${t.message}. Sending ${e.events.length} uncompressed events instead`),e.events}}),!Array.isArray(e))throw new Error("Event compressors must be constructed with an array of CompressionRules");if(!e.every(e=>e instanceof ae))throw new Error("Event compressors can only be constructed with instances of CompressionRule");this._compressionRules=e}}class le{constructor(e,t){m()(this,"push",(e,t,r,s)=>{this._eventArgs.push({identifier:e,builtEvent:t,context:r,userInfo:s})}),m()(this,"size",()=>this._eventArgs.length),m()(this,"startFlush",()=>{try{this._eventArgs=this._compressEventArgs(this._eventArgs)}catch(e){console.warn(`Failed to perform compression on the delayed analytics events. Error: ${e.message}. Sending ${this._eventArgs.length} uncompressed events instead`)}this._flushNextBatch()}),m()(this,"cancelFlush",()=>{this._flushBatchTimeout&&(clearTimeout(this._flushBatchTimeout),this._flushBatchTimeout=null)}),m()(this,"_flushNextBatch",()=>{this._eventArgs.splice(0,7).forEach(e=>this._processFn(e.identifier,e.builtEvent,e.context,e.userInfo)),this._eventArgs.length>0?this._flushBatchTimeout=setTimeout(()=>this._flushNextBatch(),100):this._flushBatchTimeout=null}),m()(this,"_compressEventArgs",e=>{const[t,r]=ie(e,e=>this._compressor.canCompress(e.builtEvent)),s=t.reduce((e,t)=>{let r=null;for(let s=0;s<e.length;s++){const i=e[s];if(se(i.userInfo,t.userInfo)&&se(i.context,t.context)){r=i;break}}return r?r.eventArgs.push(t):e.push({userInfo:t.userInfo,context:t.context,eventArgs:[t]}),e},[]).reduce((e,t)=>{try{const r=t.eventArgs.map(e=>e.builtEvent),s=this._compressor.compress(r);return s.map(e=>({identifier:q(e),builtEvent:e,userInfo:t.userInfo,context:t.context})).forEach(t=>e.push(t)),e}catch(e){return console.warn(`Failed to compress some analytics events. Error: ${e.message}. Sending ${t.eventArgs.length} uncompressed events instead`),t.eventArgs}},[]);return r.forEach(e=>s.push(e)),s}),this._processFn=e,this._flushBatchTimeout=null,this._eventArgs=[],this._compressor=new ce(t)}}let ue,he;!function(e){e.IN_PROGRESS="inProgress",e.QUEUE="queue",e.RECLAIM_START="reclaimStart",e.RECLAIM_END="reclaimEnd",e.ACK="ack"}(ue||(ue={})),function(e){e[e.RECLAIM_TIMEOUT=1e4]="RECLAIM_TIMEOUT",e[e.RECLAIM_WAIT=500]="RECLAIM_WAIT",e[e.RECLAIM_WAIT_THRESHOLD=2e3]="RECLAIM_WAIT_THRESHOLD"}(he||(he={}));const de=(e,t)=>({[ue.ACK]:`${e}.${t}.${ue.ACK}`,[ue.QUEUE]:`${e}.${t}.${ue.QUEUE}`,[ue.IN_PROGRESS]:`${e}.${t}.${ue.IN_PROGRESS}`,[ue.RECLAIM_START]:`${e}.${t}.${ue.RECLAIM_START}`,[ue.RECLAIM_END]:`${e}.${t}.${ue.RECLAIM_END}`}),me=Object.values(ue);function fe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ge=e=>new Promise(t=>{setTimeout(t,e)}),be=async(e,t)=>{const{queue:r,inProgress:s}=e.storageKeys,i=JSON.parse(localStorage.getItem(r)||"[]"),n=JSON.parse(localStorage.getItem(s)||"{}"),o=[...i,...Object.entries(n).map(([e,t])=>pe(pe({},t),{},{attemptNumber:t.attemptNumber+1,id:e}))];if(o.length>0){const i=await t(o);if("successful"===i.status)ve(e.storageKeys);else if("partial"===i.status){const e=o.filter(e=>!i.acceptedItemIds.includes(e.id));return localStorage.removeItem(s),localStorage.setItem(r,JSON.stringify(e)),{fullReclaim:!1}}}else ve(e.storageKeys);return{fullReclaim:!0}},ve=e=>{localStorage.removeItem(e.queue),localStorage.removeItem(e.inProgress),localStorage.removeItem(e.reclaimEnd),localStorage.removeItem(e.reclaimStart),localStorage.removeItem(e.ack)};var ye=async(e,t)=>{if("string"!=typeof e||0===e.length)return{fullReclaims:0,partialReclaims:0,failedReclaims:0};const r=p()(),s=(e=>Object.keys(localStorage).filter(t=>t.startsWith(e)).map(e=>e.split(".")).filter(t=>{if(3===t.length&&t[0]===e&&t[2]===ue.ACK)try{const e=localStorage.getItem(t.join("."));if(e){const t=parseInt(e);return he.RECLAIM_TIMEOUT+t<Date.now()}}catch(e){}return!1}).map(e=>e[1]))(e).map(s=>(async(e,t)=>{const{ack:r,reclaimStart:s,reclaimEnd:i}=e.storageKeys,n=Date.now();if(localStorage.setItem(s,e.reclaimProcessId),localStorage.setItem(r,n.toString()),await ge(he.RECLAIM_WAIT),Date.now()>n+he.RECLAIM_WAIT_THRESHOLD||localStorage.getItem(s)!==e.reclaimProcessId)throw new Error("Took to long to callback, reclaim abandonded. After reclaimStart.");if(localStorage.setItem(i,e.reclaimProcessId),await ge(he.RECLAIM_WAIT),Date.now()>n+he.RECLAIM_WAIT_THRESHOLD||localStorage.getItem(s)!==e.reclaimProcessId||localStorage.getItem(i)!==e.reclaimProcessId)throw new Error("Took to long to callback, reclaim abandonded. After reclaimEnd.");return be(e,t)})({queuePrefix:e,reclaimProcessId:r,storageKeys:de(e,s)},t)),i=await Promise.allSettled(s),n=i.filter(e=>"rejected"===e.status),o=i.filter(e=>"fulfilled"===e.status).map(e=>e.value),a=o.filter(e=>e.fullReclaim),c=o.filter(e=>!e.fullReclaim);return{failedReclaims:n.length,partialReclaims:c.length,fullReclaims:a.length}};let we,Ie;!function(e){e.INDEXEDDB="indexeddb",e.MEMORY="memory"}(we||(we={})),function(e){e.IGNORE="ignore",e.ABANDON="abandon",e.EVICT="evict"}(Ie||(Ie={}));class Ee extends Error{constructor(e){super("Event Limit reached. Abandoning write to: "+e),Object.setPrototypeOf(this,Ee.prototype),this.name="AbandonWriteError"}}class Oe extends Error{constructor(e){super("Error thrown while processing events in callback: "+(e&&"object"==typeof e&&"toString"in e&&"function"==typeof e.toString&&e.toString()||"string"==typeof e&&e||"Argument passed to CallbackProcessingError was not an Error or string.")),Object.setPrototypeOf(this,Oe.prototype),this.name="CallbackProcessingError"}}class Te extends Error{constructor(e,t){super(`Method '${t}' cannot be called with policy '${e}'.`),this.name="InvalidPolicyError"}}const _e=e=>{if(e&&"object"==typeof e&&"name"in e){const t=e;return"string"==typeof t.name&&("AbandonWriteError"===t.name||"CallbackProcessingError"===t.name||"InvalidPolicyError"===t.name)}return!1};var Se=r(24),ke=r.n(Se);const Pe=(e,t,{id:r,retryAttempts:s,timeToProcessOffset:i})=>({item:e,id:r||p()(),retryAttempts:s||0,timeToBeProcessedAfter:Date.now()+(i||0),namespace:t,timeAdded:Date.now()}),Ae=e=>({logger:e.logger||console,useMemory:e.useMemory||!1,maxAttempts:e.maxAttempts||10,maxEventLimit:e.maxEventLimit||5e3}),De=e=>new Promise((t,r)=>{e.onsuccess=e=>{t(e)},e.onerror=e=>{r(e)}}),je=(e,t)=>{try{"function"==typeof e.commit&&e.commit()}catch(e){throw t.error("Failed to force commit transaction:",e),e}return(e=>new Promise((t,r)=>{e.oncomplete=()=>{t()},e.onerror=e=>{r(e)},e.onabort=e=>{r(e)}}))(e)},Ce=(e,t)=>{e.onerror=e=>{t.warn("Error thrown from request:",e)}};class Ne{constructor(e,t,r,s){if(m()(this,"deleteOldestNEvents",async(e,t)=>{var r;const s=e.index("namespace-timeAdded"),i=IDBKeyRange.bound([this.namespace,0],[this.namespace,Date.now()]),n=s.getAllKeys(i,t),o=await De(n),a=null==o||null===(r=o.target)||void 0===r?void 0:r.result;if(a&&Array.isArray(a)&&a.length>0)try{const t=a.map(t=>this.deleteItemHandler(e,t));await Promise.all(t)}catch(e){throw this.logger.warn("Failed to delete items from indexeddb.",e),e}}),!(e>0))throw Error("Event Limit has to be set higher than 1");this.eventLimit=e,this.namespace=t,this.logger=r,this.deleteItemHandler=s}async insertItems(e,t,r=Ie.ABANDON){const s=[...t];let i=0;switch(r){case Ie.ABANDON:await this.throwIfNotEnoughSpace(e,t.length);break;case Ie.EVICT:i=await this.evictIfNotEnoughSpace(e,t.length);break;case Ie.IGNORE:await this.calculateHowManyEventsWeCanAdd(e,s)}const n=s.map(t=>De(e.add(t)));return await Promise.all(n),await je(e.transaction,this.logger),{items:s,numberOfEvictedItems:i}}async throwIfNotEnoughSpace(e,t){const r=await this.calculateFreeSpace(e);if(r<t)throw new Ee(`Not enough space in IndexedDb. Needed ${t} but only had ${r}`)}async evictIfNotEnoughSpace(e,t){const r=await this.calculateFreeSpace(e);if(r<t){const s=t-r;return await this.deleteOldestNEvents(e,s),s}return 0}async calculateHowManyEventsWeCanAdd(e,t){const r=await this.calculateFreeSpace(e);if(r<t.length){const e=t.length-r,s=t.length-e;t.splice(s,e)}}async calculateFreeSpace(e){const t=await this.getCountofEventsInObjectStore(e);return this.eventLimit-t}async getCountofEventsInObjectStore(e){const t=e.index("namespace-timeAdded"),r=IDBKeyRange.bound([this.namespace,0],[this.namespace,Date.now()]),s=t.count(r);return(await De(s)).target.result}}const Me=["item"],Re=["items"];function xe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}class Le{constructor(e,t={}){if(m()(this,"startDB",async()=>new Promise(async(e,t)=>{window.setTimeout(()=>t(new Error("Failed to create Indexeddb connection in time.")),15e3);const r=window.indexedDB.open("analytics-web-client",1);r.onupgradeneeded=e=>{if(0!==e.oldVersion)throw new Error("We cannot upgarde the database. Do not do this.");const t=r.result.createObjectStore("analytics-resilience",{keyPath:"id"});t.createIndex("timeToBeProcessedAfter","timeToBeProcessedAfter",{unique:!1}),t.createIndex("retryAttempts","retryAttempts",{unique:!1}),t.createIndex("timeAdded","timeAdded",{unique:!1}),t.createIndex("namespace-timeAdded",["namespace","timeAdded"],{unique:!1})};try{return await De(r),e(r.result)}catch(e){this.logger.error("IndexedDB failed to initialise.",e),t(new Error("IndexedDB failed to initialise: "+e.message))}})),m()(this,"addItem",async(e,t={},r=Ie.ABANDON)=>{const{logger:s,namespace:i}=this,n=Pe(e,i,t),{objectStore:o}=await this.getObjectStoreAndTransaction("readwrite");if(r===Ie.IGNORE)throw new Te(r,"IndexedDbConnector#addItem");try{if(!n.namespace||0===n.namespace.length||"string"!=typeof n.namespace)throw new Error("Namespace not specified");const e=await this.globalEventLimitGuard.insertItems(o,[n],r);if(1===e.items.length)return{item:e.items[0],numberOfEvictedItems:e.numberOfEvictedItems};throw new Error("Incorrect number of items added. Expected: 1, got: "+e.items.length)}catch(e){if(_e(e))throw e;throw s.log("Failed to add item to table",e),new Error("Request to add item to table failed")}}),m()(this,"bulkAddItem",async(e,t=Ie.ABANDON)=>{const{logger:r,namespace:s}=this,i=e.map(e=>{let{item:t}=e,r=ke()(e,Me);return Pe(t,s,r)}),{objectStore:n}=await this.getObjectStoreAndTransaction("readwrite");try{return await this.globalEventLimitGuard.insertItems(n,i,t)}catch(e){if(_e(e))throw e;throw r.log("Failed to add item to table",e),new Error("Request to add item to table failed")}}),m()(this,"getItems",async(e=7)=>{const t=e>0?e:7,{logger:r}=this,s=this.options.maxAttempts,{transaction:i,objectStore:n}=await this.getObjectStoreAndTransaction("readwrite"),o=n.index("timeToBeProcessedAfter"),a=IDBKeyRange.upperBound(Date.now()),c=o.openCursor(a),l=await new Promise(async(e,i)=>{const n=[];let o=0;c.onerror=e=>{r.error("Failed to open cursor:",e),i("Failed to open cursor")},c.onsuccess=i=>{const a=i.target.result;if(a){const i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},a.value);n.push(i);const c=a.value;if(c.retryAttempts+=1,c.timeToBeProcessedAfter=Date.now()+6e4,c.retryAttempts>=s){++o;const e=a.delete();Ce(e,r)}else{const e=a.update(c);Ce(e,r)}n.length<t?a.continue():e({items:n,numberOfDeletedItems:o})}else e({items:n,numberOfDeletedItems:o})}});return await je(i,this.logger),l}),m()(this,"deleteItems",async e=>{const{transaction:t,objectStore:r}=await this.getObjectStoreAndTransaction("readwrite");try{const s=e.map(e=>this.deleteItem(r,e));await je(t,this.logger),await Promise.all(s)}catch(e){throw this.logger.warn("Failed to delete items from indexeddb.",e),e}}),m()(this,"getItemCount",async()=>{const{transaction:e,objectStore:t}=await this.getObjectStoreAndTransaction("readonly"),r=t.index("timeToBeProcessedAfter"),s=IDBKeyRange.upperBound(Date.now()),i=r.count(s),n=await De(i);return await je(e,this.logger),n.target.result}),m()(this,"processItems",async(e,t=7)=>{const r=await this.getItems(t),{items:s}=r,i=ke()(r,Re);try{const t=await e(s,i),r=s.map(e=>e.id);return await this.deleteItems(r),t}catch(e){throw new Oe(e)}}),m()(this,"deleteItem",async(e,t)=>{const{logger:r}=this;try{await De(e.delete(t))}catch(e){throw r.error("Failed to delete item:",t,e),e}}),m()(this,"getObjectStoreAndTransaction",async e=>{const t=(await this.db).transaction("analytics-resilience",e),r=t.objectStore("analytics-resilience");return{transaction:t,objectStore:r}}),this.options=Ae(t),this.namespace=e,this.logger=this.options.logger,!window.indexedDB)throw this.logger.warn("Browser doesn't support a IndexedDB."),new Error("IndexedDB not supported");this.db=this.startDB(),this.globalEventLimitGuard=new Ne(this.options.maxEventLimit,this.namespace,this.logger,this.deleteItem)}storeType(){return we.INDEXEDDB}}class Ue{constructor(e,t){if(m()(this,"insertItemsToMemoryStore",(e,t)=>{switch(t){case Ie.ABANDON:return this.handleAbandonIfLimitWillExceedPolicy(e);case Ie.EVICT:return Promise.resolve(this.handleEvictOldestIfLimitExceededPolicy(e));case Ie.IGNORE:return this.handleAddAsManyAsPossible(e)}}),!(e>0))throw Error("Event Limit has to be set higher than 1");this.eventLimit=e,this.memoryItemHandlers=t}async handleAbandonIfLimitWillExceedPolicy(e){if(await this.memoryItemHandlers.getItemCount()+e.length>this.eventLimit)throw new Ee(we.MEMORY);return this.memoryItemHandlers.addItems(e),{items:e,numberOfEvictedItems:0}}handleEvictOldestIfLimitExceededPolicy(e){this.memoryItemHandlers.addItems(e);return{items:e,numberOfEvictedItems:this.memoryItemHandlers.evictEventsIfNeeded(this.eventLimit)}}async handleAddAsManyAsPossible(e){const t=this.eventLimit-await this.memoryItemHandlers.getItemCount(),r=t>e.length?e:e.slice(0,t);return this.memoryItemHandlers.addItems(r),{items:r,numberOfEvictedItems:0}}}const Fe=["item"],Be=["items"];function He(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?He(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):He(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class $e{constructor(e,t={}){this.namespace=e,this.memoryStore=[],this.options=Ae(t),this.globalEventLimitGuard=new Ue(this.options.maxEventLimit,{addItems:this.addItems.bind(this),getItemCount:this.getItemCount.bind(this),evictEventsIfNeeded:this.evictEventsIfNeeded.bind(this)})}async addItem(e,t={},r=Ie.ABANDON){if(r===Ie.IGNORE)throw new Te(r,"IndexedDbConnector#addItem");const s=Pe(e,this.namespace,t),i=await this.globalEventLimitGuard.insertItemsToMemoryStore([s],r);return Promise.resolve({item:i.items[0],numberOfEvictedItems:i.numberOfEvictedItems})}bulkAddItem(e,t=Ie.ABANDON){const r=e.map(e=>{let{item:t}=e,r=ke()(e,Fe);return Pe(t,this.namespace,r)});return this.bulkAddItemWrapperType(r,t)}bulkAddItemWrapperType(e,t=Ie.ABANDON){return Promise.resolve(this.globalEventLimitGuard.insertItemsToMemoryStore(e,t))}getItems(e=7){return Promise.resolve(this.synchronousGetItems(e))}synchronousGetItems(e=7){const t=e>0?e:7,r=Date.now(),s=[],i=[];for(let e of this.memoryStore)if(e.timeToBeProcessedAfter<=r&&(s.push(We({},e)),e.timeToBeProcessedAfter+=6e4,e.retryAttempts+=1,e.retryAttempts>=this.options.maxAttempts&&i.push(e)),s.length>=t)break;return i.forEach(e=>{const t=this.memoryStore.indexOf(e);this.memoryStore.splice(t,1)}),{items:s,numberOfDeletedItems:i.length}}deleteItems(e){return this.memoryStore=this.memoryStore.filter(t=>!e.includes(t.id)),Promise.resolve(void 0)}getItemCount(){const e=Date.now(),t=this.memoryStore.filter(t=>t.timeToBeProcessedAfter<=e).length;return Promise.resolve(t)}async processItems(e,t){const r=this.synchronousGetItems(t),{items:s}=r,i=ke()(r,Be),n=s.map(e=>e.id);try{const t=await e(s,i);return await this.deleteItems(n),t}catch(e){throw new Oe(e)}}storeType(){return we.MEMORY}addItems(e){this.memoryStore.push(...e),this.memoryStore.sort((function(e,t){return e.timeAdded-t.timeAdded}))}evictEventsIfNeeded(e){const t=this.memoryStore.length;if(t>e){const r=t-e;return this.memoryStore.splice(0,r),r}return 0}}var Ge=class{constructor(e,t={}){if(this.namespace=e,this.options=Ae(t),!e||0===e.length||"string"!=typeof e)throw new Error("Invalid namespace provided");this.resilience=this.getResilienceMechanism(e,t)}getResilienceMechanism(e,t){if(!t.useMemory)try{return new Le(e,t)}catch(e){var r;null===(r=t.logger)||void 0===r||r.warn("Attempted to create IndexedDbResilience but failed. Using memory instead.")}return new $e(this.namespace,t)}addItem(e,t,r=Ie.ABANDON){return this.runOrFailOver(()=>this.resilience.addItem(e,t,r))}bulkAddItem(e,t=Ie.ABANDON){return this.runOrFailOver(()=>this.resilience.bulkAddItem(e,t))}getItems(e){return this.runOrFailOver(()=>this.resilience.getItems(e))}deleteItems(e){return this.runOrFailOver(()=>this.resilience.deleteItems(e))}getItemCount(){return this.runOrFailOver(()=>this.resilience.getItemCount())}processItems(e,t){return this.runOrFailOver(()=>this.resilience.processItems(e,t))}storeType(){return this.resilience.storeType()}async runOrFailOver(e){try{return await e()}catch(t){if(_e(t))throw t;return this.resilience.storeType()===we.INDEXEDDB&&await this.failOver(),e()}}async failOver(){const e=this.resilience,t=new $e(this.namespace,this.options);this.resilience=t;try{const{items:r}=await e.getItems(this.options.maxEventLimit);if(r.length>0){const s=(await t.bulkAddItemWrapperType(r,Ie.IGNORE)).items.map(e=>e.id);await e.deleteItems(s)}}catch(e){this.options.logger.warn("Unexpected error from ResilienceDb, switching to MemoryDb")}}};let Ke,Ve;!function(e){e.INDEXEDDB="indexeddb",e.MEMORY="memory"}(Ke||(Ke={})),function(e){e[e.ONLINE=0]="ONLINE",e[e.OFFLINE=1]="OFFLINE"}(Ve||(Ve={}));class ze{constructor(){m()(this,"itemsDiscardedByRetry",0),m()(this,"eventCount",0),m()(this,"itemsDiscardedByOverflow",0),m()(this,"resilienceMechanism",Ke.INDEXEDDB),m()(this,"localstorageNumberOfQueuesPurged",0),m()(this,"localstorageNumberOfFullReclaims",0),m()(this,"localstorageNumberOfPartialReclaims",0),m()(this,"localstorageNumberOfFailedReclaims",0)}addToItemsDiscardedByRetryCounter(e=1){this.itemsDiscardedByRetry+=e}addToEventCount(){this.eventCount++}addToItemsDiscardedByOverflowCounter(e=1){this.itemsDiscardedByOverflow+=e}setResilienceMechanism(e){this.resilienceMechanism=e}addToReclaimMetrics(e){this.localstorageNumberOfFullReclaims+=e.fullReclaims,this.localstorageNumberOfPartialReclaims+=e.partialReclaims,this.localstorageNumberOfFailedReclaims+=e.failedReclaims}addToPurgedQueuesMetrics(e){this.localstorageNumberOfQueuesPurged+=e}subtractFromMetrics(e){this.itemsDiscardedByRetry=this.subtractFromCount(this.itemsDiscardedByRetry,e.itemsDiscardedByRetry),this.eventCount=this.subtractFromCount(this.eventCount,e.eventCount),this.itemsDiscardedByOverflow=this.subtractFromCount(this.itemsDiscardedByOverflow,e.itemsDiscardedByOverflow),this.localstorageNumberOfFullReclaims=this.subtractFromCount(this.localstorageNumberOfFullReclaims,e.fullReclaims),this.localstorageNumberOfPartialReclaims=this.subtractFromCount(this.localstorageNumberOfPartialReclaims,e.partialReclaims),this.localstorageNumberOfFailedReclaims=this.subtractFromCount(this.localstorageNumberOfFailedReclaims,e.failedReclaims),this.localstorageNumberOfQueuesPurged=this.subtractFromCount(this.localstorageNumberOfQueuesPurged,e.localstorageQueuesPurged)}subtractFromCount(e,t){return Math.max(e-(t||0),0)}getMetricsPayload(){return{itemsDiscardedByRetry:this.itemsDiscardedByRetry,eventCount:this.eventCount,itemsDiscardedByOverflow:this.itemsDiscardedByOverflow,resilienceMechanism:this.resilienceMechanism,localstorageQueuesPurged:this.localstorageNumberOfQueuesPurged,fullReclaims:this.localstorageNumberOfFullReclaims,partialReclaims:this.localstorageNumberOfPartialReclaims,failedReclaims:this.localstorageNumberOfFailedReclaims}}}let qe=null;var Qe=()=>(qe||(qe=new ze),qe);class Je{constructor(e){window.addEventListener("offline",()=>e(Ve.OFFLINE)),window.addEventListener("online",()=>e(Ve.ONLINE))}getNetworkStatus(){return window.navigator.onLine?Ve.ONLINE:Ve.OFFLINE}}let Xe,Ye,Ze;!function(e){e.IDLE="idle",e.RUNNING="running",e.COMPLETED="completed",e.TIMED_OUT="timedOut"}(Xe||(Xe={})),function(e){e.EXECUTE="execute",e.COMPLETE="complete",e.TIMEOUT="timeout"}(Ye||(Ye={}));class et{constructor(e){if(m()(this,"timeoutHandle",void 0),m()(this,"callbackStatus",Xe.IDLE),!(e>0))throw new Error("CallbackWithTimeout requires timeout period higher than 0");this.timeoutPeriod=e}transitionCallbackStatus(e,t){switch(e){case Xe.IDLE:case Xe.TIMED_OUT:case Xe.COMPLETED:t===Ye.EXECUTE&&(this.callbackStatus=Xe.RUNNING);break;case Xe.RUNNING:switch(t){case Ye.COMPLETE:this.callbackStatus=Xe.COMPLETED;break;case Ye.TIMEOUT:this.callbackStatus=Xe.TIMED_OUT}break;default:this.callbackStatus=e}}executeCallbackWithTimeout(e,t,r){this.transitionCallbackStatus(this.callbackStatus,Ye.EXECUTE),this.timeoutHandle=window.setTimeout(()=>{this.transitionCallbackStatus(this.callbackStatus,Ye.TIMEOUT),r()},this.timeoutPeriod),e(e=>{this.cancelTimeout(),this.getCallbackStatus()!==Xe.TIMED_OUT&&(this.transitionCallbackStatus(this.callbackStatus,Ye.COMPLETE),t(e))})}getCallbackStatus(){return this.callbackStatus}cancelTimeout(){this.timeoutPeriod>0&&this.timeoutHandle&&(window.clearTimeout(this.timeoutHandle),this.timeoutHandle=void 0)}}!function(e){e[e.NOOP=0]="NOOP",e[e.SUCCESS=1]="SUCCESS",e[e.ERROR=2]="ERROR"}(Ze||(Ze={}));const tt=1e3,rt=3e4,st=2,it=0,nt=500,ot=5e3;let at;!function(e){e[e.NONE=0]="NONE",e[e.IMMEDIATE=1]="IMMEDIATE",e[e.WAIT=2]="WAIT"}(at||(at={}));class ct{constructor(e,t){m()(this,"schedule",({immediate:e}={immediate:!1})=>{this.operationInFlight?e?this.queuedSchedule=at.IMMEDIATE:this.queuedSchedule!==at.IMMEDIATE&&(this.queuedSchedule=at.WAIT):(e||this.options.waitInterval<=0)&&0===this.failureCount?(this.clearTimeout(),this.run()):this.failureCount>0&&null===this.scheduledTimeout?this.scheduledTimeout=window.setTimeout(this.run,this.calculateBackoff()):null===this.scheduledTimeout&&(this.scheduledTimeout=window.setTimeout(this.run,this.options.waitInterval))}),m()(this,"stop",()=>{this.clearTimeout(),this.queuedSchedule=at.NONE}),m()(this,"getFailureCount",()=>this.failureCount),m()(this,"getCallbackStatus",()=>this.callbackTimer.getCallbackStatus()),m()(this,"clearTimeout",()=>{null!==this.scheduledTimeout&&(window.clearTimeout(this.scheduledTimeout),this.scheduledTimeout=null)}),m()(this,"run",()=>{this.operationInFlight=!0,this.clearTimeout();try{this.callbackTimer.executeCallbackWithTimeout(this.callback,this.done,()=>this.done(Ze.ERROR))}catch(e){this.done(e)}}),m()(this,"done",e=>{this.operationInFlight=!1,e===Ze.ERROR||this.callbackTimer.getCallbackStatus()===Xe.TIMED_OUT?(this.failureCount++,this.clearTimeout()):e===Ze.SUCCESS&&(this.failureCount=0),this.processQueuedSchedule()}),m()(this,"processQueuedSchedule",()=>{if(this.queuedSchedule!==at.NONE){const e=this.queuedSchedule===at.IMMEDIATE;this.queuedSchedule=at.NONE,this.schedule({immediate:e})}else this.failureCount>0&&this.schedule()}),m()(this,"calculateBackoff",()=>{const{minRetryDelay:e,maxRetryDelay:t,backoffFactor:r,backoffJitterPercentage:s}=this.options;let i=e*r**this.failureCount;if(s){const e=Math.random(),t=Math.floor(e*s*i);Math.floor(10*e)<5?i-=t:i+=t}return Number(Math.min(i,t).toPrecision(1))}),this.options={minRetryDelay:e.minRetryDelay||tt,maxRetryDelay:e.maxRetryDelay||rt,backoffFactor:e.backoffFactor||st,backoffJitterPercentage:e.backoffJitterPercentage||it,waitInterval:void 0!==e.waitInterval?e.waitInterval:nt,callbackTimeoutPeriod:e.callbackTimeoutPeriod||ot},this.scheduledTimeout=null,this.failureCount=0,this.callback=t,this.operationInFlight=!1,this.queuedSchedule=at.NONE,this.callbackTimer=new et(this.options.callbackTimeoutPeriod)}}function lt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const ht={backoffFactor:0,backoffJitterPercentage:0,flushWaitMs:6e4,minRetryDelay:6e4,maxRetryDelay:6e4},dt=2,mt=.2,ft=7,pt=!1,gt=500,bt=10,vt=1e3,yt=3e4,wt=1e3;class It{constructor(e,t,r,s){this.queuePrefix=e,this.resilience=new Ge(t,{logger:s,maxAttempts:null==r?void 0:r.maxAttempts,maxEventLimit:null==r?void 0:r.maxItems}),this.options=this.buildOptions(r),this.scheduler=new ct(ut(ut({},this.options),{},{waitInterval:null!=r&&r.flushBeforeUnload?0:this.options.flushWaitMs}),this.scheduleCallback.bind(this)),this.longPollingScheduler=new ct(ut(ut({},ht),{},{waitInterval:ht.flushWaitMs}),this.scheduleLongCallBack.bind(this)),this.metricsCollector=Qe(),this.networkStatus=new Je(e=>{e===Ve.OFFLINE?this.scheduler.stop():this.checkEventCountAndReschedule()})}start(e){this.batchFlushCallback=e,this.longPollingScheduler.schedule()}stop(){this.scheduler.stop(),this.longPollingScheduler.stop()}async addItem(e){const t=JSON.parse(JSON.stringify(e)),{numberOfEvictedItems:r}=await this.resilience.addItem(t,{},Ie.EVICT);this.scheduler.schedule(),this.metricsCollector.addToEventCount(),r>0&&this.metricsCollector.addToItemsDiscardedByOverflowCounter(r)}getGlobalRetryCount(){return this.scheduler.getFailureCount()}async scheduleCallback(e){if(this.networkStatus.getNetworkStatus()!==Ve.OFFLINE)try{e(await this.resilience.processItems(this.flush.bind(this),this.options.batchFlushSize))}catch(t){if("CallbackProcessingError"===t.name)return void e(Ze.ERROR)}finally{await this.checkEventCountAndReschedule()}else e(Ze.NOOP)}async checkEventCountAndReschedule(){const e=await this.resilience.getItemCount();e>0&&this.scheduler.schedule({immediate:e>=this.options.batchFlushSize})}async scheduleLongCallBack(e){const t=(e=>{if("string"!=typeof e||0===e.length)return 0;try{const t=Object.keys(localStorage).filter(t=>t&&t.startsWith(e+".")||!1).map(e=>e.split(".")).filter(e=>3===e.length&&me.includes(e[2])).reduce((e,t)=>{const[,r,s]=t;return void 0===e[r]&&(e[r]={}),e[r][s]=!0,e},{}),r=Object.keys(t).filter(e=>!0!==t[e][ue.ACK]);return r.forEach(t=>{const{queue:r,inProgress:s,reclaimStart:i,reclaimEnd:n}=de(e,t);localStorage.removeItem(s),localStorage.removeItem(r),localStorage.removeItem(i),localStorage.removeItem(n)}),r.length}catch(e){}return 0})(this.queuePrefix);this.metricsCollector.addToPurgedQueuesMetrics(t);const r=await ye(this.queuePrefix,async e=>{const t=e.map(e=>({item:e.item,retryAttempts:e.attemptNumber,id:e.id})),{items:r}=await this.resilience.bulkAddItem(t,Ie.IGNORE);return r.length===t.length?{status:"successful"}:{status:"partial",acceptedItemIds:r.map(e=>e.id)}});this.metricsCollector.addToReclaimMetrics(r),await this.checkEventCountAndReschedule(),e(Ze.SUCCESS),this.longPollingScheduler.schedule()}flush(e,t){this.metricsCollector.setResilienceMechanism(this.resilience.storeType());const{batchFlushCallback:r}=this;if(!r)throw new Error("batchFlushCallback has not been set. Call PullBatchableQueue#start first.");return new Promise((s,i)=>{if(e.length<=0)return void s(Ze.NOOP);const n=e.map(e=>{const t=e.item;return e.retryAttempts>0&&t.msg&&(t.msg._metadata||(t.msg._metadata={}),t.msg._metadata.failedAttempts=e.retryAttempts),t});r(n,e=>{e?(t.numberOfDeletedItems>0&&this.metricsCollector.addToItemsDiscardedByRetryCounter(t.numberOfDeletedItems),i(e)):s(Ze.SUCCESS)})})}buildOptions(e){return{backoffFactor:(null==e?void 0:e.backoffFactor)||dt,backoffJitterPercentage:void 0!==(null==e?void 0:e.backoffJitterPercentage)?e.backoffJitterPercentage:mt,batchFlushSize:(null==e?void 0:e.batchFlushSize)||ft,flushBeforeUnload:(null==e?void 0:e.flushBeforeUnload)||pt,flushWaitMs:(null==e?void 0:e.flushWaitMs)||gt,maxItems:(null==e?void 0:e.maxItems)||vt,maxAttempts:(null==e?void 0:e.maxAttempts)||bt,maxRetryDelay:(null==e?void 0:e.maxRetryDelay)||yt,minRetryDelay:(null==e?void 0:e.minRetryDelay)||wt}}}let Et,Ot,Tt;function _t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function St(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}async function kt(e,t){try{const r=await t;return e.map(e=>function(e,t){if(!(t&&t instanceof Function))return e;if(e.msg.type===Et.PAGE||e.msg.type===Et.TRACK){const r=t();r&&Array.isArray(r)&&(e.msg.properties=St(St({},e.msg.properties),{},{xid:r}))}else if(e.msg.traits&&e.msg.type===Et.IDENTIFY){const r=t();r&&Array.isArray(r)&&(e.msg.traits=St(St({},e.msg.traits),{},{xid:r}))}return e}(e,r))}catch(t){return e}}!function(e){e.IDENTIFY="identify",e.PAGE="page",e.TRACK="track"}(Et||(Et={})),function(e){e.XC="xc",e.UID="uid"}(Ot||(Ot={})),function(e){e.NEW="NEW",e.CHANGED="CHANGED",e.EXISTING="EXISTING",e.TIMEOUT="TIMEOUT",e.ERROR="ERROR",e.UNAVAILABLE="UNAVAILABLE",e.MALFORMED="MALFORMED",e.UNKNOWN="UNKNOWN"}(Tt||(Tt={}));var Pt=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function At(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(s=e[r],i=t[r],!(s===i||Pt(s)&&Pt(i)))return!1;var s,i;return!0}function Dt(e,t){void 0===t&&(t=At);var r=null;function s(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(r&&r.lastThis===this&&t(s,r.lastArgs))return r.lastResult;var n=e.apply(this,s);return r={lastResult:n,lastArgs:s,lastThis:this},n}return s.clear=function(){r=null},s}function jt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}const Ct=async e=>{var t;const r=null===(t=Nt(e))||void 0===t?void 0:t.signal,s=Mt(e.url),i=await fetch(e.url,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jt(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(e.batch),signal:r},s));if(429===i.status||i.status>=500&&i.status<600)throw new Error(`HTTP Error ${i.status} (${i.statusText})`);return i},Nt=e=>{if(e.abortController)return e.abortController;if(e.timeout){const t=new AbortController;return setTimeout(()=>{t.abort()},e.timeout),t}},Mt=Dt(e=>new URL(e).origin===location.origin?{}:{mode:"cors",credentials:"include"});var Rt=r(73),xt=r(476),Lt=r(66);function Ut(e,t){var r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}var Ft=r(335),Bt=r.n(Ft);const Ht={expires:365,secure:"https:"===window.location.protocol,path:"/"};var Wt=new class{constructor(){m()(this,"_data",{}),m()(this,"length",0),m()(this,"setItem",(e,t)=>(this._data[e]=t,this.length=Object.keys(this._data).length,t)),m()(this,"getItem",e=>e in this._data?this._data[e]:null),m()(this,"removeItem",e=>(e in this._data&&delete this._data[e],this.length=Object.keys(this._data).length,null)),m()(this,"clear",()=>{this._data={},this.length=0}),m()(this,"key",e=>Object.keys(this._data)[e])}};function $t(e){if(!e)return!1;try{const t="awc.storage.support";e.setItem(t,"test_value");const r=e.getItem(t);return e.removeItem(t),"test_value"===r}catch(e){return!1}}class Gt{constructor(e,t={}){m()(this,"getStore",()=>this._store),m()(this,"getItem",e=>this._store.getItem(this.createKey(e))),m()(this,"removeItem",e=>this._store.removeItem(this.createKey(e))),m()(this,"setItem",(e,t)=>{try{this._store.setItem(this.createKey(e),t)}catch(r){(function(e){let t=!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t})(r)&&(this.swapToInMemory(),this._store.setItem(this.createKey(e),t))}}),m()(this,"swapToInMemory",()=>{if(this._store===Wt)return;const e=Object.keys(this._store||{});let t;$t(window.awcInMemoryStorageFallback)?t=window.awcInMemoryStorageFallback:(t=Wt,window.awcInMemoryStorageFallback||(window.awcInMemoryStorageFallback=Wt)),e.forEach(e=>{if(0===e.indexOf(this.getPrefix())){const r=this._store.getItem(e);r&&t.setItem(e,r)}}),this._store=t}),m()(this,"clear",()=>this._store.clear()),m()(this,"key",e=>this._store.key(e)),m()(this,"getPrefix",()=>this._prefix),m()(this,"createKey",e=>this._prefix?`${this.getPrefix()}.${e}`:e),this.options=t;const r=[];(void 0===t.useStoragePrefix||t.useStoragePrefix)&&r.push("awc"),t.envPrefix&&t.envPrefix!==g.PROD&&r.push(t.envPrefix),this._prefix=r.join("-"),$t(e)?this._store=e:this.swapToInMemory()}}var Kt=class extends Gt{constructor(e){let t;try{t=window.localStorage||Wt}catch(e){t=Wt}super(t,e)}};class Vt{constructor(){this.safeStorage=new Kt({useStoragePrefix:!1})}set(e,t){return this.safeStorage.setItem(e,t),t}get(e){return this.safeStorage.getItem(e)||void 0}remove(e){this.safeStorage.removeItem(e)}}const zt=Dt(()=>{const{hostname:e}=location,t=e.split(".");for(let e=1;e<=t.length;e++){const r="."+t.slice(-1*e).join(".");if(Bt.a.set("__awc_tld_test__","tld_test",{domain:r}),"tld_test"===Bt.a.get("__awc_tld_test__"))return Bt.a.remove("__awc_tld_test__"),r}return e});function qt(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Qt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?qt(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qt(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Jt{constructor(){this.cookieLike="file:"!==location.protocol&&"chrome-extension:"!==location.protocol?Bt.a:new Vt}set(e,t,r){return this.cookieLike.set(e,t,Qt(Qt({},Ht),{},{domain:zt()},r))}get(e){return this.cookieLike.get(e)}remove(e,t){this.cookieLike.remove(e,Qt({},t))}}class Xt{constructor(){this.store=new Kt({useStoragePrefix:!1}),this.cookie=new Jt}getUserId(){return this.userId||null}setUserId(e){this.userId=e}getAnonymousId(){const e=this.store.getItem("ajs_anonymous_id");if(e){const t=JSON.parse(e);return(!this.lastAnonymousIdCookieUpdate||function(e,t){Object(Lt.a)(2,arguments);var r=Object(Rt.a)(e),s=Object(Rt.a)(t),i=Ut(r,s),n=Math.abs(Object(xt.a)(r,s));r.setDate(r.getDate()-i*n);var o=Number(Ut(r,s)===-i),a=i*(n-o);return 0===a?0:a}(new Date,new Date(this.lastAnonymousIdCookieUpdate))>=7)&&this.setAnonymousId(t),t}{const e=this.cookie.get("ajs_anonymous_id");if(e){const t=JSON.parse(e);return this.store.setItem("ajs_anonymous_id",e),t}}const t=p()();return this.setAnonymousId(t),t}setAnonymousId(e){return this.cookie.set("ajs_anonymous_id",JSON.stringify(e)),this.lastAnonymousIdCookieUpdate=Date.now(),this.store.setItem("ajs_anonymous_id",JSON.stringify(e))}}var Yt=r(1342),Zt=r.n(Yt);function er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function tr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?er(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const rr=e=>{const t=sr(e);return Zt()(t)},sr=e=>{const t={};return Object.keys(e).forEach(r=>{const s=ir(e,r);void 0!==s&&(Array.isArray(s)?t[r]=s.map(e=>e):t[r]="object"==typeof s&&null!==s?sr(s):s)}),t},ir=(e,t)=>e[t];function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class ar{constructor(e){m()(this,"sendEvents",async(e,t)=>{const r=this.resilienceQueue.getGlobalRetryCount(),s=this.metrics.getMetricsPayload(),i=or(or({},s),{},{httpRetryCount:r});for(let e in i)0===i[e]&&delete i[e];const n=await this.attachXIDs(e),o=(new Date).toISOString(),a={batch:n.map(e=>(e.msg.sentAt=o,e.msg)),sentAt:o,metadata:i};try{const e=await Ct({url:this.gasv3BatchUrl,batch:a,timeout:this.options.requestTimeout});this.metrics.subtractFromMetrics(s),t(null,e)}catch(e){t(e,null)}}),this.user=new Xt,this.options=or(or({},e),{},{requestTimeout:e.requestTimeout||1e4,retryQueueOptions:e.retryQueueOptions||{},logger:e.logger||console}),this.xidPromiseCallback=e.xidPromiseGetter(),this.gasv3BatchUrl=`https://${e.apiHost}/batch`,this.metrics=Qe(),this.resilienceQueue=((e,t,r,s)=>new It(e,t,r||{},s))(e.retryQueuePrefix,e.product,this.options.retryQueueOptions,this.options.logger),this.resilienceQueue.start(this.sendEvents)}getUser(){return this.user}async track(e,t,r,s){const i=or(or({},this.buildBaseEvent(r,Et.TRACK)),{},{type:Et.TRACK,properties:rr(t),event:e}),n=or(or({},i),{},{messageId:this.createMessageId()}),o=this.packageEvent(n);await this.resilienceQueue.addItem(o),s&&s()}async page(e,t,r,s){const i=or(or({},this.buildBaseEvent(r,Et.PAGE)),{},{type:Et.PAGE,properties:rr(t),name:e}),n=or(or({},i),{},{messageId:this.createMessageId()}),o=this.packageEvent(n);await this.resilienceQueue.addItem(o),s&&s()}async identify(e,t,r,s){const i=or(or({},this.buildBaseEvent(r,Et.IDENTIFY)),{},{type:Et.IDENTIFY,traits:rr(t)}),n=or(or({},i),{},{messageId:this.createMessageId()}),o=this.packageEvent(n);await this.resilienceQueue.addItem(o),s&&s()}buildBaseEvent(e,t){return{context:(e=>tr(tr({},e.context),{},{userAgent:navigator.userAgent}))(rr(e)),timestamp:(new Date).toISOString(),type:t,userId:this.user.getUserId(),anonymousId:this.user.getAnonymousId()}}createMessageId(){return"ajs-"+p()()}packageEvent(e){const{apiHost:t}=this.options;return{headers:{"Content-Type":"text/plain"},msg:e,url:`https://${t}/${e.type.charAt(0)}`}}async attachXIDs(e){return this.xidPromiseCallback?kt(e,this.xidPromiseCallback):Promise.resolve(e)}}var cr=r(336);const lr=e=>window.history.replaceState({},"",e);var ur=(e,t=lr)=>{const r=window.location.href,s=window.location.hash,i=""!==s?r.replace(s,""):r,{url:n,query:o}=Object(cr.parseUrl)(i),a=(c=o,l=e,Object.keys(c).filter(e=>l(c[e],e)).reduce((e,t)=>(e[t]=c[t],e),{}));var c,l;if(Object.keys(a).length>0){const r=((e,t)=>Object.keys(e).filter(r=>!t(e[r],r)).reduce((t,r)=>(t[r]=e[r],t),{}))(o,e);if(Object.keys(r).length>0){t(`${n}?${Object(cr.stringify)(r)}${s}`)}else t(`${n}${s}`)}return a};class hr{constructor(){m()(this,"handleOriginParameters",(e,t)=>{const r=Object.keys(e);if(!(r.length>0))throw new Error("Empty parameter mapping provided");const s=r.filter(e=>Object.values(_).indexOf(e)<0);if(s.length>0)throw new Error(`Invalid Origin Tracing Parameter(s) supplied: ${s.join()}!`);const i=ur((e,t)=>r.indexOf(t)>=0,t);return Object.keys(i).map(t=>({[t]:e[t](i[t])})).reduce((e,t)=>Object.assign(e,t),{})}),this._originStore={}}}const dr=/^\d+$/;class mr{constructor(e={}){m()(this,"_generateNewSessionId",()=>{const e=Date.now().toString();return this._safeLocalStorage.setItem("session.id",e),e}),m()(this,"_updateSessionExpiry",()=>{const e=Date.now()+this._sessionExpiryTime;return this._safeLocalStorage.setItem("session.expiry",e.toString()),e}),m()(this,"_debouncedUpdateSessionExpiry",e=>{const{_updateSessionExpiry:t}=this;if(e<Date.now()+this._sessionExpiryDebounceThresholdPercentage*this._sessionExpiryTime)return t();this._sessionExpiryDebounceTimer&&clearTimeout(this._sessionExpiryDebounceTimer),this._sessionExpiryDebounceTimer=setTimeout(()=>{t()},this._sessionExpiryDebounce)}),this._sessionExpiryTime=e.sessionExpiryTime||18e5,this._sessionExpiryDebounce=e.sessionExpiryDebounce||5e3,this._sessionExpiryDebounceThresholdPercentage=e.sessionExpiryDebounceThresholdPercentage||.9,this._safeLocalStorage=new Kt}getCurrentSessionId(){const e=this._safeLocalStorage.getItem("session.id"),t=parseInt(this._safeLocalStorage.getItem("session.expiry")||"0",10)||0;return this._debouncedUpdateSessionExpiry(t),!e||t<=Date.now()||Number.isNaN(t)?this._generateNewSessionId():dr.test(e)?e:this._generateNewSessionId()}}var fr=class extends Gt{constructor(e){let t;try{t=window.sessionStorage||Wt}catch(e){t=Wt}super(t,e)}};class pr{constructor(){m()(this,"_generateNewTabId",()=>{const e=p()();return this._safeSessionStorage.setItem("tab.id",e),e}),this._safeSessionStorage=new fr}getCurrentTabId(){let e=this._safeSessionStorage.getItem("tab.id");return e||(e=this._generateNewTabId()),e}}function gr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gr(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const vr="taskSessionsInit";class yr{constructor(){m()(this,"_taskSessionsNotRecentlyInitialised",e=>null===this._safeSessionStorage.getItem("taskSessions")||null===this._safeSessionStorage.getItem(vr)||parseInt(this._safeSessionStorage.getItem(vr)||"0",10)<e-3e3),m()(this,"_removeTaskSessionPrefix",(e,t)=>t.split("awc.")[1]),m()(this,"_isTaskSessionQueryParam",(e,t)=>t.startsWith("awc.")),m()(this,"getAllTaskSessions",()=>{try{return JSON.parse(this._safeSessionStorage.getItem("taskSessions")||"")}catch(e){return{}}}),m()(this,"_writeToSessionStorage",e=>{try{this._safeSessionStorage.setItem("taskSessions",JSON.stringify(e))}catch(e){}}),m()(this,"_appendTaskSessions",e=>{const t=this.getAllTaskSessions(),r=null===t?e:Object.assign(t,e);this._writeToSessionStorage(r)}),m()(this,"_safelyRemoveKey",(e,t)=>null===e?{}:(delete e[t],e)),m()(this,"createTaskSession",e=>{const t=p()(),r={};return r[e]=t,this._appendTaskSessions(r),t}),m()(this,"createTaskSessionWithProvidedId",(e,t)=>{if("string"!=typeof t)throw new TypeError("invalid taskSessionId, must be string");const r={};r[e]=t,this._appendTaskSessions(r)}),m()(this,"completeTaskSession",e=>{const t=this.getAllTaskSessions(),r=this._safelyRemoveKey(t,e);this._writeToSessionStorage(r)}),m()(this,"formatTaskSessionQueryString",({uri:e,includedTaskSessions:t})=>{const{url:r,query:s}=Object(cr.parseUrl)(e),i=this.getAllTaskSessions(),n=t?(o=i,t.reduce((e,t)=>(t in o&&(e[t]=o[t]),e),{})):re(i,Object.values(_));var o;if(0===Object.keys(n).length)return e;const a=br(br({},te(n,(e,t)=>"awc."+t)),s);return`${r}?${Object(cr.stringify)(a)}`}),m()(this,"stripQueryParameters",()=>{const e=te(ur(this._isTaskSessionQueryParam),this._removeTaskSessionPrefix);this._appendTaskSessions(e)});const e=Date.now();this._safeSessionStorage=new fr;try{this._taskSessionsNotRecentlyInitialised(e)&&(this._writeToSessionStorage({}),this._safeSessionStorage.setItem(vr,e.toString()))}catch(e){}}}var wr=class{constructor(){m()(this,"_bind",()=>{window.testAnalytics||(window.testAnalytics={eventCache:[],events:()=>window.testAnalytics.eventCache,clear:()=>{window.testAnalytics.eventCache=[],localStorage.removeItem("awc.ui.viewed.last.sent"),localStorage.removeItem("awc-staging.ui.viewed.last.sent"),localStorage.removeItem("awc-dev.ui.viewed.last.sent"),localStorage.removeItem("awc-local.ui.viewed.last.sent")}})}),m()(this,"_cache",e=>{window.testAnalytics.eventCache.length>=100&&(window.testAnalytics.eventCache=window.testAnalytics.eventCache.slice(1,window.testAnalytics.eventCache.length)),window.testAnalytics.eventCache.push(e)}),m()(this,"_shouldCacheEvent",()=>this._isDebugCookieEnabled),m()(this,"saveEvent",e=>{e&&this._shouldCacheEvent()&&(window.testAnalytics||this._bind(),e.tags instanceof Array?e.tags.push("synthetic"):e.tags=["synthetic"],this._cache(e))}),this._isDebugCookieEnabled=(()=>{try{return JSON.parse(Bt.a.get("atlassian_analytics_debug")||"false")}catch(e){Bt.a.remove("atlassian_analytics_debug")}return!1})(),this._isDebugCookieEnabled&&this._bind()}};const Ir=["embeddedProduct"];function Er(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Er(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Er(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class Tr{constructor(e,t,r,s={}){if(m()(this,"start",()=>{this._startInterval(),this._bindEventListeners()}),m()(this,"stop",()=>{this._stopInterval(),this._unbindEventListeners()}),m()(this,"resetTimers",()=>{this._intervalId&&(this.stop(),this.start())}),m()(this,"_bindEventListeners",()=>{window.addEventListener("focus",this._focusListener),window.addEventListener("blur",this._blurListener)}),m()(this,"_unbindEventListeners",()=>{window.removeEventListener("focus",this._focusListener),window.removeEventListener("blur",this._blurListener)}),m()(this,"_startInterval",()=>{clearInterval(this._intervalId),this._intervalId=setInterval(this._handleInterval,this._delay)}),m()(this,"_stopInterval",()=>{this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)}),m()(this,"_getProductKey",(e,t)=>{let r=e;return t&&(r+="-"+t),r}),m()(this,"_getLastSentTimestamp",(e,t,r)=>(((this._parseLocalStorageData()||{})[r]||{})[t]||{})[e]||null),m()(this,"_parseLocalStorageData",()=>{const e=this._safeLocalStorage.getItem(this._storageKey);try{return JSON.parse(e||"")}catch(e){return this._safeLocalStorage.removeItem(this._storageKey),null}}),m()(this,"_setLastSentTimestamp",(e,t,r)=>{const s=this._parseLocalStorageData()||{},i=s[r]||{},n=i[t]||{};n[e]=Date.now(),i[t]=n,s[r]=i,this._safeLocalStorage.setItem(this._storageKey,JSON.stringify(s))}),m()(this,"_shouldSendEvent",(e,t,r,s)=>{if(!document.hasFocus())return!1;if(t!==w.NONE&&!r||!s)return!1;return Date.now()-this._getLastSentTimestamp(e,r,s)>this._throttle}),m()(this,"_handleInterval",()=>{const e=this._getContext(),{embeddedProduct:t}=e,r=ke()(e,Ir);this._sendEvent(this._product,r),t&&this._sendEvent(t,r,!0)}),m()(this,"_sendEvent",(e,t,r=!1)=>{const{subproduct:s,tenantIdType:i,tenantId:n,userId:o,lastScreenEvent:a,attributes:c}=t,l=this._getProductKey(e,s);if(this._shouldSendEvent(l,i,n,o)){this._setLastSentTimestamp(l,n,o);const t=this._createEvent(e,s,r,a,c);this._onEvent(t)}}),m()(this,"_createEvent",(e,t,r,s,i)=>{const n={product:e,source:"ui",action:"viewed",actionSubject:"ui",attributes:i};return r&&(n.subproduct=null,n.version=null,n.attributes=Or(Or({},n.attributes),{},{embeddedInEnv:this._productInfo.env,embeddedInProduct:this._productInfo.product,embeddedInSubproduct:t,embeddedInVersion:this._productInfo.version,embeddedInOrigin:this._productInfo.origin,embeddedInPlatform:this._productInfo.platform})),s&&(n.attributes=Or(Or({},n.attributes),{},{lastScreenEvent:{name:s.name,attributes:s.attributes}})),n}),!e)throw new Error("Missing productInfo");if(!e.product)throw new Error("Missing productInfo.product");if(!t)throw new Error("Missing getContext callback");if("function"!=typeof t)throw new Error("Invalid getContext, must be function");if(!r)throw new Error("Missing onEvent callback");if("function"!=typeof r)throw new Error("Invalid onEvent, must be function");this._productInfo=e,this._product=e.product,this._getContext=t,this._onEvent=r,this._delay=s.delay||2e3,this._throttle=s.throttle||36e5,this._storageKey=s.storageKey||"ui.viewed.last.sent",this._safeLocalStorage=new Kt({envPrefix:this._productInfo.env}),this._focusListener=()=>{this._startInterval()},this._blurListener=()=>{this._stopInterval()}}}function _r(e,t){return e&&"function"==typeof e?()=>{e(t)}:null}let Sr,kr;!function(e){e.XC="xc",e.UID="uid"}(Sr||(Sr={})),function(e){e.NEW="NEW",e.CHANGED="CHANGED",e.EXISTING="EXISTING",e.TIMEOUT="TIMEOUT",e.ERROR="ERROR",e.UNAVAILABLE="UNAVAILABLE",e.MALFORMED="MALFORMED",e.UNKNOWN="UNKNOWN"}(kr||(kr={}));const Pr=(e,t)=>{if(e&&t&&"function"==typeof t){const e=()=>new Promise(e=>{setTimeout(()=>e(()=>[{type:Sr.XC,state:"TIMEOUT"},{type:Sr.UID,state:"TIMEOUT"}]),5e3)}),r=()=>t().catch(()=>()=>[{type:Sr.XC,state:"UNKNOWN"},{type:Sr.UID,state:"UNKNOWN"}]);return Promise.race([r(),e()])}};function Ar(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ar(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ar(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class jr{constructor(e,t={}){if(m()(this,"_useStargate",e=>null==e||e),m()(this,"_selectHost",({useStargate:e,env:t,useLegacyUrl:r})=>e?r?t===g.PROD?"api-private.atlassian.com/gasv3/api/v1":"api-private.stg.atlassian.com/gasv3/api/v1":window.location.host+"/gateway/api/gasv3/api/v1":t===g.PROD?"as.atlassian.com/api/v1":"as.staging.atl-paas.net/api/v1"),m()(this,"_endsWith",(e,t)=>-1!==e.indexOf(t,e.length-t.length)),m()(this,"_changeInternalUserId",(e,t)=>{this.eventProcessor.getUser().setUserId(e),t&&t!==this.eventProcessor.getUser().getAnonymousId()&&this.eventProcessor.getUser().setAnonymousId(t)}),m()(this,"_createSubproductGetter",e=>N(e,"Cannot get subproduct from the callback. Proceeding without it.")),m()(this,"_createEmbeddedProductGetter",e=>N(e,"Cannot get embeddedProduct from the callback. Proceeding without it.")),m()(this,"_getLastScreenEvent",()=>{try{return JSON.parse(this._safeSessionStorage.getItem("last.screen.event")||"")}catch(e){return this._safeSessionStorage.removeItem("last.screen.event"),null}}),m()(this,"_setLastScreenEvent",e=>{this._safeSessionStorage.setItem("last.screen.event",JSON.stringify({name:e.name,attributes:e.attributes}))}),m()(this,"_shouldEventBeDelayed",e=>{if(!e.tags||-1===e.tags.indexOf("measurement"))return!1;const t=!1!==e.highPriority;return this._isDelayingLowPriorityEvents&&!t}),m()(this,"_fireEvent",(e,t,r,s)=>{switch(t.eventType){case b.UI:case b.OPERATIONAL:case b.TRACK:return this.eventProcessor.track(e,t,r,s);case b.SCREEN:return this.eventProcessor.page(e,t,r,s);case b.IDENTIFY:return this.eventProcessor.identify(e,t,r,s);default:throw new Error("No handler has been defined for events of type "+t.eventType)}}),m()(this,"_fireDelayedEvent",(e,t,r,s)=>{try{this._changeInternalUserId(s.userId,s.anonymousId),t.tags=[...t.tags||[],"sentWithDelay"],this._fireEvent(e,t,r,void 0)}finally{this._changeInternalUserId(this._userInfo.userId,this._userInfo.anonymousId)}}),m()(this,"_delayEvent",(e,t,r,s,i)=>{this._delayQueue.push(e,t,r,s),i&&i()}),m()(this,"_processEvent",(e,t,r,s)=>(this._testingCache.saveEvent(t),this._shouldEventBeDelayed(t)?(this._delayEvent(e,t,r,this._userInfo,s),Promise.resolve()):this._fireEvent(e,t,r,s))),m()(this,"setEmbeddedProduct",e=>{this._productInfo.embeddedProduct=this._createEmbeddedProductGetter(e),this.resetUIViewedTimers()}),m()(this,"clearEmbeddedProduct",()=>{this._productInfo.embeddedProduct=this._createEmbeddedProductGetter(null)}),m()(this,"setSubproduct",e=>{this._productInfo.subproduct=this._createSubproductGetter(e),this.resetUIViewedTimers()}),m()(this,"setOriginTracingHandlers",e=>{const t=this.originTracing.handleOriginParameters(e,this._historyReplaceFn);Object.keys(t).forEach(e=>{void 0!==t[e].taskSessionId&&this.task.createTaskSessionWithProvidedId(e,t[e].taskSessionId)});const r={};return Object.keys(t).forEach(e=>{t[e].originTracingAttributes?r[e]=t[e].originTracingAttributes:console.warn(`Handling method for origin parameter ${e} has not returned any attributes`)}),Object.keys(t).length>0?this.sendOperationalEvent({action:"landed",actionSubject:"origin",source:"webClient",attributes:{originTracesLanded:r}},()=>{}):Promise.resolve()}),m()(this,"setTenantInfo",(e,t)=>{if(!e)throw new Error("Missing tenantIdType");if(e!==w.NONE&&!t)throw new Error("Missing tenantId");if(!k(w,e))throw new Error(`Invalid tenantIdType '${e}', must be an tenantType: [${S(w)}]`);this._tenantInfo={tenantIdType:e,tenantId:t}}),m()(this,"clearTenantInfo",()=>{this._tenantInfo={}}),m()(this,"setOrgInfo",e=>{if(!e)throw new Error("Missing orgId");this._orgInfo={orgId:e}}),m()(this,"clearOrgInfo",()=>{this._orgInfo={}}),m()(this,"setUserInfo",(e,t)=>{!function(e,t){if(!e)throw new Error("Missing userIdType");if(!t)throw new Error("Missing userId");if(!k(I,e))throw new Error(`Invalid userIdType '${e}', must be an userType: [${S(I)}]`)}(e,t),this._changeInternalUserId(t),this._userInfo={userIdType:e,userId:t,anonymousId:this.eventProcessor.getUser().getAnonymousId()}}),m()(this,"clearUserInfo",()=>{this._changeInternalUserId(void 0),this._userInfo={anonymousId:this.eventProcessor.getUser().getAnonymousId()}}),m()(this,"setUIViewedAttributes",e=>{if(!e)throw new Error("Missing uiViewedAttributes");if("object"!=typeof e||Array.isArray(e))throw new Error("Invalid uiViewedAttributes type, should be a non array object");this._uiViewedAttributes=Dr({},e)}),m()(this,"clearUIViewedAttributes",()=>{this._uiViewedAttributes={}}),m()(this,"sendIdentifyEvent",(e,t,r)=>{this.setUserInfo(e,t);const s={userIdType:e,eventType:b.IDENTIFY};return this._processEvent(t,s,this._context,r)}),m()(this,"sendPageEvent",(e,t)=>this.sendScreenEvent(e,t)),m()(this,"sendScreenEvent",(e,t,r)=>{let s,i,n,o;"object"==typeof e?(s=e.name,i=e.attributes,n=e.containers,o=e.tags):(s=e,i=r),function(e){if(!e)throw new Error("Missing name")}(s),X(n);const a=z(this._productInfo,this._tenantInfo,this._userInfo,i,e.nonPrivacySafeAttributes,o,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId,n),c=Dr({name:s},a);return this._setLastScreenEvent(c),this._processEvent(s,a,this._context,_r(t,c))}),m()(this,"sendTrackEvent",(e,t)=>{!function(e){Z(e)}(e);const r=Q(this._productInfo,this._tenantInfo,this._userInfo,e,b.TRACK,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId);return this._processEvent(q(e),r,this._context,_r(t,r))}),m()(this,"sendUIEvent",(e,t)=>{!function(e){Z(e)}(e);const r=Q(this._productInfo,this._tenantInfo,this._userInfo,e,b.UI,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId);return this._processEvent(q(e),r,this._context,_r(t,r))}),m()(this,"sendOperationalEvent",(e,t)=>{!function(e){Z(e)}(e);const r=Q(this._productInfo,this._tenantInfo,this._userInfo,e,b.OPERATIONAL,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId);return this._processEvent(q(e),r,this._context,_r(t,r))}),m()(this,"startUIViewedEvent",e=>{this.stopUIViewedEvent(),this._uiViewedEvent=new Tr(this._productInfo,()=>({embeddedProduct:this._productInfo.embeddedProduct(),subproduct:this._productInfo.subproduct(),tenantIdType:this._tenantInfo.tenantIdType,tenantId:this._tenantInfo.tenantId,userId:this._userInfo.userId,lastScreenEvent:this._getLastScreenEvent(),attributes:this._uiViewedAttributes}),t=>this.sendUIEvent(t,e)),this._uiViewedEvent.start()}),m()(this,"stopUIViewedEvent",()=>{this._uiViewedEvent&&(this._uiViewedEvent.stop(),this._uiViewedEvent=null)}),m()(this,"resetUIViewedTimers",()=>{this._uiViewedEvent&&this._uiViewedEvent.resetTimers()}),m()(this,"startApdexEvent",e=>{this._apdexEvent.start(e)}),m()(this,"getApdexStart",e=>this._apdexEvent.getStart(e)),m()(this,"stopApdexEvent",(e,t)=>{this._apdexEvent.stop(e,t)}),m()(this,"startLowPriorityEventDelay",e=>{if(void 0!==e&&(Number.isNaN(e)||e<=0))throw new Error(`Invalid timeout period: ${e}, must be a number greater than 0`);this._delayTimeout&&clearTimeout(this._delayTimeout);const t=e?Math.min(e,1e4):1e4;this._delayTimeout=setTimeout(()=>this.stopLowPriorityEventDelay(),t),this._delayQueue.cancelFlush(),this._isDelayingLowPriorityEvents=!0}),m()(this,"stopLowPriorityEventDelay",()=>{this._delayTimeout&&(clearTimeout(this._delayTimeout),this._delayTimeout=null),this._delayQueue.startFlush(),this._isDelayingLowPriorityEvents=!1}),m()(this,"onEvent",(e,t)=>{if(!t)throw new Error("Missing analyticsData");if(!t.eventType)throw new Error("Missing analyticsData.eventType");if(t.eventType===b.TRACK)return this.sendTrackEvent(t);if(t.eventType===b.UI)return this.sendUIEvent(t);if(t.eventType===b.OPERATIONAL)return this.sendOperationalEvent(t);if(t.eventType===b.SCREEN)return this.sendScreenEvent(t.name,null,t.attributes);if(t.eventType===b.IDENTIFY)return this.sendIdentifyEvent(t.userIdType,t.userId);throw new Error(`Invalid analyticsData.eventType '${t.eventType}', must be an eventType: [${S(b)}]`)}),!e)throw new Error("Missing productInfo");if(!e.env)throw new Error("Missing productInfo.env");if(!e.product)throw new Error("Missing productInfo.product");if(!k(g,e.env))throw new Error(`Invalid productInfo.env '${e.env}', must be an envType: [${S(g)}]`);if(e.origin){if(!k(y,e.origin))throw new Error(`Invalid productInfo.origin '${e.origin}', must be an originType: [${S(y)}]`)}else e.origin=y.WEB;e.platform?function(e){if(!k(v,e.platform))throw new Error(`Invalid productInfo.platform '${e.platform}', must be a platformType: [${S(v)}]`);if(e.origin===y.DESKTOP&&!k(O,e.platform))throw new Error(`Invalid productInfo.platform '${e.platform}', must be one of [mac, linux, windows]`);if(e.origin===y.WEB&&!k(T,e.platform))throw new Error(`Invalid productInfo.platform '${e.platform}', must be one of [web, mobileWeb]`)}(e):e.platform=e.origin===y.WEB?v.WEB:v.DESKTOP,this.logger=t.logger||console,this._productInfo=Dr(Dr({},e),{},{subproduct:this._createSubproductGetter(e.subproduct),embeddedProduct:this._createEmbeddedProductGetter(e.embeddedProduct)}),this._tenantInfo={},this._orgInfo={},this._uiViewedAttributes={},this._context=function(e){const t=window.screen||{};return{context:{locale:e.locale,screen:{width:t.width,height:t.height,density:window.devicePixelRatio},library:{name:"analytics.js",version:"4.0.0"}}}}(this._productInfo),this._safeSessionStorage=new fr;const r=this._useStargate(t.useStargate),s=t.apiHost||this._selectHost({useStargate:r,env:e.env,useLegacyUrl:t.useLegacyUrl}),i={maxRetryDelay:6e4,minRetryDelay:t.minRetryDelay||1e3,backoffFactor:2,flushWaitMs:t.flushWaitInterval,flushBeforeUnload:t.flushBeforeUnload},n="awc-"+e.env;this.eventProcessor=new ar({apiHost:s,product:e.product,retryQueuePrefix:n,retryQueueOptions:i,xidPromiseGetter:()=>Pr(t.xidConsent,t.xidPromiseFn),logger:this.logger}),this._userInfo={anonymousId:this.eventProcessor.getUser().getAnonymousId()},this._pageVisibility=new P,this._tabTracking=new pr,this._sessionTracking=new mr({sessionExpiryTime:t.sessionExpiryTime}),this.task=new yr,this.originTracing=new hr,this._apdexEvent=new C(this.sendOperationalEvent,this._pageVisibility),this._historyReplaceFn="function"==typeof t.historyReplaceFn?t.historyReplaceFn:lr,this._delayQueue=new le(this._fireDelayedEvent,t.delayQueueCompressors),this._testingCache=new wr,this._pageLoadId=p()()}}var Cr=r(341),Nr=r.n(Cr);function Mr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const xr={initialPollInterval:5,pollBackoffRate:2,idleTimeout:30};class Lr{constructor(e,t,r,s){if(m()(this,"start",()=>{if(Nr.a.active)throw new Error("DwellTimeHelper should only be initialised once per page load.");this._initDwellTimeCounterAndPolling(),window.addEventListener("beforeunload",()=>{this.stop()})}),m()(this,"stop",()=>{Nr.a.active&&this._sendDwellEvent(this._eventData,this._searchSessionId,!0),Nr.a.stopAllTimers(),Nr.a.resetAllRecordedPageTimes(),Nr.a.timeElapsedCallbacks=[]}),m()(this,"newPage",(e,t)=>{ee(e),this.stop(),this._eventData=e,this._searchSessionId=t,this._initDwellTimeCounterAndPolling()}),m()(this,"_initDwellTimeCounterAndPolling",()=>{Nr.a.initialize({idleTimeoutInSeconds:this._timing.idleTimeout}),this._pollDwellTime(this._timing.initialPollInterval,this._searchSessionId,this._eventData)}),m()(this,"_pollDwellTime",(e,t,r)=>{Nr.a.callAfterTimeElapsedInSeconds(e,()=>{this._sendDwellEvent(r,t,!1),this._pollDwellTime(e*this._timing.pollBackoffRate,t,r)})}),m()(this,"_sendDwellEvent",(e,t,r)=>{const s={dwellTime:Nr.a.getTimeOnCurrentPageInMilliseconds(),searchReferrer:t,finalDwellEvent:r};this._trackCallback({action:"dwelled",actionSubject:e.actionSubject,actionSubjectId:e.actionSubjectId,source:e.source,containerType:e.containerType,containerId:e.containerId,containers:e.containers,objectType:e.objectType,objectId:e.objectId,attributes:Rr(Rr({},s),e.attributes),tags:e.tags})}),!e)throw new Error("trackCallback is required for DwellTimeHelper");ee(t),this._trackCallback=e,this._eventData=t,this._searchSessionId=r,this._timing=Rr(Rr({},xr),s)}}var Ur=r(1343);function Fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fr(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Hr={initialPollInterval:5e3,idleTimeout:3e4,multiplierCallback:e=>e+e};class Wr{constructor(e,t,r,s){if(m()(this,"start",()=>{this.browserInteractionTime.startTimer(),this.browserInteractionTime.addTimeIntervalEllapsedCallback({callback:e=>this._sendDwellEvent(this._eventData,this._searchSessionId,e,!1),timeInMilliseconds:this._timing.initialPollInterval,multiplier:this._timing.multiplierCallback}),window.addEventListener("beforeunload",this._onBeforeUnload)}),m()(this,"stop",()=>{this.browserInteractionTime.isRunning()&&this._sendDwellEvent(this._eventData,this._searchSessionId,this.browserInteractionTime.getTimeInMilliseconds(),!0),this.browserInteractionTime.stopTimer()}),m()(this,"newPage",(e,t)=>{ee(e),this.stop(),this.browserInteractionTime.reset(),this.setEventData(e),this.setSearchSessionId(t),this.start()}),m()(this,"setEventData",e=>{this._eventData=e}),m()(this,"getEventData",()=>this._eventData),m()(this,"setSearchSessionId",e=>{this._searchSessionId=e}),m()(this,"getSearchSessionId",()=>this._searchSessionId),m()(this,"destroy",()=>{this.browserInteractionTime.destroy(),window.removeEventListener("beforeunload",this._onBeforeUnload)}),m()(this,"_onBeforeUnload",()=>{this.stop(),this.destroy()}),m()(this,"_sendDwellEvent",(e,t,r,s)=>{const i={dwellTime:r,searchReferrer:t,finalDwellEvent:s};this._trackCallback({action:"dwelled",actionSubject:e.actionSubject,actionSubjectId:e.actionSubjectId,source:e.source,containerType:e.containerType,containerId:e.containerId,objectType:e.objectType,objectId:e.objectId,attributes:Br(Br({},i),e.attributes),tags:e.tags})}),!e)throw new Error("trackCallback is required for DwellTimeHelper");ee(t),this._trackCallback=e,this._eventData=t,this._searchSessionId=r,this._timing=Br(Br({},Hr),s),this.browserInteractionTime=new Ur.a({idleTimeoutMs:this._timing.idleTimeout,checkCallbacksIntervalMs:500})}}function $r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function Gr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$r(Object(r),!0).forEach((function(t){m()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$r(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Kr(e,t,r){const s=Gr({action:e},r);return s.attributes=Gr(Gr({},t),s.attributes),s}class Vr{constructor(e,t){this._onEvent=e,this._baseEvent=t,this._searchStartedTime=null,this._lastQueryResultsTime=null,this._queryLength=null,this._baseEvent=Gr({},t)}search(e){if(!e&&""!==e)throw new Error("Missing query param");this._searchStartedTime=Date.now(),this._queryLength=(e||"").length}searched(e){if(!e)throw new Error("Missing results param");if(null===this._queryLength)throw new Error("search() must be called before searched().");const t=Date.now()-this._searchStartedTime;this._lastQueryResultsTime=Date.now(),this._lastResults=e;const r=Kr("searched",{responseTimeMs:t,queryLength:this._queryLength,results:e},this._baseEvent);this._onEvent(r)}selected(e){if(!e&&0!==e)throw new Error("Missing selectionIndex param");if(!this._lastQueryResultsTime)throw new Error("searched() must be called before selected().");const t=Date.now(),r=t-this._lastQueryResultsTime,s=t-this._searchStartedTime,i=this._lastResults[e],n=Kr("selected",{queryLength:this._queryLength,selectionIndex:e,selectionTimeMs:r,searchTimeMs:s,selectedResultValue:i},this._baseEvent);this._onEvent(n)}}void 0!==window.awc_resolve&&null!==window.awc_resolve||(window.awc=new Promise((function(e,t){window.awc_resolve=e}))),window.awc_resolve(s),Object.assign(window,{Bloodhound:n.a,Strftime:a.a,_:l.a,typeahead:h.a})},335:function(e,t,r){var s,i;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(n){if(void 0===(i="function"==typeof(s=n)?s.call(t,r,t,e):s)||(e.exports=i),!0,e.exports=n(),!!0){var o=window.Cookies,a=window.Cookies=n();a.noConflict=function(){return window.Cookies=o,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var s in r)t[s]=r[s]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(s){function i(){}function n(t,r,n){if("undefined"!=typeof document){"number"==typeof(n=e({path:"/"},i.defaults,n)).expires&&(n.expires=new Date(1*new Date+864e5*n.expires)),n.expires=n.expires?n.expires.toUTCString():"";try{var o=JSON.stringify(r);/^[\{\[]/.test(o)&&(r=o)}catch(e){}r=s.write?s.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in n)n[c]&&(a+="; "+c,!0!==n[c]&&(a+="="+n[c].split(";")[0]));return document.cookie=t+"="+r+a}}function o(e,r){if("undefined"!=typeof document){for(var i={},n=document.cookie?document.cookie.split("; "):[],o=0;o<n.length;o++){var a=n[o].split("="),c=a.slice(1).join("=");r||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var l=t(a[0]);if(c=(s.read||s)(c,l)||t(c),r)try{c=JSON.parse(c)}catch(e){}if(i[l]=c,e===l)break}catch(e){}}return e?i[e]:i}}return i.set=n,i.get=function(e){return o(e,!1)},i.getJSON=function(e){return o(e,!0)},i.remove=function(t,r){n(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}((function(){}))}))},341:function(e,t,r){var s;(function(){!function(r,i){if(e.exports)return e.exports=i();void 0===(s=function(){return r.TimeMe=i()}.apply(t,[]))||(e.exports=s)}(this,(function(){var e={startStopTimes:{},idleTimeoutMs:3e4,currentIdleTimeMs:0,checkStateRateMs:250,active:!1,idle:!1,currentPageName:"default-page-name",timeElapsedCallbacks:[],userLeftCallbacks:[],userReturnCallbacks:[],trackTimeOnElement:function(t){var r=document.getElementById(t);r&&(r.addEventListener("mouseover",(function(){e.startTimer(t)})),r.addEventListener("mousemove",(function(){e.startTimer(t)})),r.addEventListener("mouseleave",(function(){e.stopTimer(t)})),r.addEventListener("keypress",(function(){e.startTimer(t)})),r.addEventListener("focus",(function(){e.startTimer(t)})))},getTimeOnElementInSeconds:function(t){var r=e.getTimeOnPageInSeconds(t);return r||0},startTimer:function(t){if(t||(t=e.currentPageName),void 0===e.startStopTimes[t])e.startStopTimes[t]=[];else{var r=e.startStopTimes[t],s=r[r.length-1];if(void 0!==s&&void 0===s.stopTime)return}e.startStopTimes[t].push({startTime:new Date,stopTime:void 0}),e.active=!0},stopAllTimers:function(){for(var t=Object.keys(e.startStopTimes),r=0;r<t.length;r++)e.stopTimer(t[r])},stopTimer:function(t){t||(t=e.currentPageName);var r=e.startStopTimes[t];void 0!==r&&0!==r.length&&(void 0===r[r.length-1].stopTime&&(r[r.length-1].stopTime=new Date),e.active=!1)},getTimeOnCurrentPageInSeconds:function(){return e.getTimeOnPageInSeconds(e.currentPageName)},getTimeOnPageInSeconds:function(t){return void 0===e.getTimeOnPageInMilliseconds(t)?void 0:e.getTimeOnPageInMilliseconds(t)/1e3},getTimeOnCurrentPageInMilliseconds:function(){return e.getTimeOnPageInMilliseconds(e.currentPageName)},getTimeOnPageInMilliseconds:function(t){var r=e.startStopTimes[t];if(void 0!==r){for(var s=0,i=0;i<r.length;i++){var n=r[i].startTime,o=r[i].stopTime;void 0===o&&(o=new Date),s+=o-n}return Number(s)}},getTimeOnAllPagesInSeconds:function(){for(var t=[],r=Object.keys(e.startStopTimes),s=0;s<r.length;s++){var i=r[s],n=e.getTimeOnPageInSeconds(i);t.push({pageName:i,timeOnPage:n})}return t},setIdleDurationInSeconds:function(t){var r=parseFloat(t);if(!1!==isNaN(r))throw{name:"InvalidDurationException",message:"An invalid duration time ("+t+") was provided."};return e.idleTimeoutMs=1e3*t,this},setCurrentPageName:function(t){return e.currentPageName=t,this},resetRecordedPageTime:function(t){delete e.startStopTimes[t]},resetAllRecordedPageTimes:function(){for(var t=Object.keys(e.startStopTimes),r=0;r<t.length;r++)e.resetRecordedPageTime(t[r])},resetIdleCountdown:function(){e.idle&&e.triggerUserHasReturned(),e.idle=!1,e.currentIdleTimeMs=0},callWhenUserLeaves:function(e,t){this.userLeftCallbacks.push({callback:e,numberOfTimesToInvoke:t})},callWhenUserReturns:function(e,t){this.userReturnCallbacks.push({callback:e,numberOfTimesToInvoke:t})},triggerUserHasReturned:function(){if(!e.active)for(var t=0;t<this.userReturnCallbacks.length;t++){var r=this.userReturnCallbacks[t],s=r.numberOfTimesToInvoke;(isNaN(s)||void 0===s||s>0)&&(r.numberOfTimesToInvoke-=1,r.callback())}e.startTimer()},triggerUserHasLeftPage:function(){if(e.active)for(var t=0;t<this.userLeftCallbacks.length;t++){var r=this.userLeftCallbacks[t],s=r.numberOfTimesToInvoke;(isNaN(s)||void 0===s||s>0)&&(r.numberOfTimesToInvoke-=1,r.callback())}e.stopAllTimers()},callAfterTimeElapsedInSeconds:function(t,r){e.timeElapsedCallbacks.push({timeInSeconds:t,callback:r,pending:!0})},checkState:function(){for(var t=0;t<e.timeElapsedCallbacks.length;t++)e.timeElapsedCallbacks[t].pending&&e.getTimeOnCurrentPageInSeconds()>e.timeElapsedCallbacks[t].timeInSeconds&&(e.timeElapsedCallbacks[t].callback(),e.timeElapsedCallbacks[t].pending=!1);!1===e.idle&&e.currentIdleTimeMs>e.idleTimeoutMs?(e.idle=!0,e.triggerUserHasLeftPage()):e.currentIdleTimeMs+=e.checkStateRateMs},visibilityChangeEventName:void 0,hiddenPropName:void 0,listenForVisibilityEvents:function(){void 0!==document.hidden?(e.hiddenPropName="hidden",e.visibilityChangeEventName="visibilitychange"):void 0!==document.mozHidden?(e.hiddenPropName="mozHidden",e.visibilityChangeEventName="mozvisibilitychange"):void 0!==document.msHidden?(e.hiddenPropName="msHidden",e.visibilityChangeEventName="msvisibilitychange"):void 0!==document.webkitHidden&&(e.hiddenPropName="webkitHidden",e.visibilityChangeEventName="webkitvisibilitychange"),document.addEventListener(e.visibilityChangeEventName,(function(){document[e.hiddenPropName]?e.triggerUserHasLeftPage():e.triggerUserHasReturned()}),!1),window.addEventListener("blur",(function(){e.triggerUserHasLeftPage()})),window.addEventListener("focus",(function(){e.triggerUserHasReturned()})),document.addEventListener("mousemove",(function(){e.resetIdleCountdown()})),document.addEventListener("keyup",(function(){e.resetIdleCountdown()})),document.addEventListener("touchstart",(function(){e.resetIdleCountdown()})),window.addEventListener("scroll",(function(){e.resetIdleCountdown()})),setInterval((function(){e.checkState()}),e.checkStateRateMs)},websocket:void 0,websocketHost:void 0,setUpWebsocket:function(t){if(window.WebSocket&&t){var r=t.websocketHost;try{e.websocket=new WebSocket(r),window.onbeforeunload=function(r){e.sendCurrentTime(t.appId)},e.websocket.onopen=function(){e.sendInitWsRequest(t.appId)},e.websocket.onerror=function(e){console&&console.log("Error occurred in websocket connection: "+e)},e.websocket.onmessage=function(e){console&&console.log(e.data)}}catch(e){console&&console.error("Failed to connect to websocket host.  Error:"+e)}}return this},websocketSend:function(t){e.websocket.send(JSON.stringify(t))},sendCurrentTime:function(t){var r={type:"INSERT_TIME",appId:t,timeOnPageMs:e.getTimeOnCurrentPageInMilliseconds(),pageName:e.currentPageName};e.websocketSend(r)},sendInitWsRequest:function(t){var r={type:"INIT",appId:t};e.websocketSend(r)},initialize:function(t){var r=e.idleTimeoutMs||30,s=e.currentPageName||"default-page-name",i=void 0;t&&(r=t.idleTimeoutInSeconds||r,s=t.currentPageName||s,i=t.websocketOptions),e.setIdleDurationInSeconds(r).setCurrentPageName(s).setUpWebsocket(i).listenForVisibilityEvents(),e.startTimer()}};return e}))}).call(this)},69:function(e,t){e.exports=jQuery}},[[2e3,1,0]]]);
//# sourceMappingURL=globals-2aa3069bd43e6bf97ab3.chunk.js.map